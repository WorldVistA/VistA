Released PSO*7*463 SEQ #431
Extracted from mail message
**KIDS**:PSO*7.0*463^

**INSTALL NAME**
PSO*7.0*463
"BLD",10189,0)
PSO*7.0*463^OUTPATIENT PHARMACY^0^3180117^y
"BLD",10189,4,0)
^9.64PA^^
"BLD",10189,6.3)
36
"BLD",10189,"ABPKG")
n
"BLD",10189,"INID")
n^n^n
"BLD",10189,"KRN",0)
^9.67PA^779.2^20
"BLD",10189,"KRN",.4,0)
.4
"BLD",10189,"KRN",.401,0)
.401
"BLD",10189,"KRN",.402,0)
.402
"BLD",10189,"KRN",.403,0)
.403
"BLD",10189,"KRN",.5,0)
.5
"BLD",10189,"KRN",.84,0)
.84
"BLD",10189,"KRN",3.6,0)
3.6
"BLD",10189,"KRN",3.8,0)
3.8
"BLD",10189,"KRN",9.2,0)
9.2
"BLD",10189,"KRN",9.8,0)
9.8
"BLD",10189,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",10189,"KRN",9.8,"NM",1,0)
PSOCPB^^0^B93273887
"BLD",10189,"KRN",9.8,"NM",2,0)
PSOCPF^^0^B65916211
"BLD",10189,"KRN",9.8,"NM",3,0)
PSOCPF1^^0^B49346922
"BLD",10189,"KRN",9.8,"NM",4,0)
PSOCPF2^^0^B16086034
"BLD",10189,"KRN",9.8,"NM","B","PSOCPB",1)

"BLD",10189,"KRN",9.8,"NM","B","PSOCPF",2)

"BLD",10189,"KRN",9.8,"NM","B","PSOCPF1",3)

"BLD",10189,"KRN",9.8,"NM","B","PSOCPF2",4)

"BLD",10189,"KRN",19,0)
19
"BLD",10189,"KRN",19,"NM",0)
^9.68A^3^2
"BLD",10189,"KRN",19,"NM",2,0)
PSOCP MENU^^2
"BLD",10189,"KRN",19,"NM",3,0)
PSOCP RESET COPAY STATUS LM^^0
"BLD",10189,"KRN",19,"NM","B","PSOCP MENU",2)

"BLD",10189,"KRN",19,"NM","B","PSOCP RESET COPAY STATUS LM",3)

"BLD",10189,"KRN",19.1,0)
19.1
"BLD",10189,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",10189,"KRN",101,0)
101
"BLD",10189,"KRN",101,"NM",0)
^9.68A^11^10
"BLD",10189,"KRN",101,"NM",1,0)
PSO PATIENT MEDICATION MENU^^0
"BLD",10189,"KRN",101,"NM",2,0)
PSO PATIENT MED ACC PRO^^0
"BLD",10189,"KRN",101,"NM",3,0)
PSO PATIENT MED BILL PRO^^0
"BLD",10189,"KRN",101,"NM",5,0)
PSO PATIENT MED TPJI^^0
"BLD",10189,"KRN",101,"NM",6,0)
PSO PATIENT MED CANCEL^^0
"BLD",10189,"KRN",101,"NM",7,0)
PSO PATIENT MED RESET^^0
"BLD",10189,"KRN",101,"NM",8,0)
PSO PATIENT MED EXPORT^^0
"BLD",10189,"KRN",101,"NM",9,0)
PSO PATIENT MED NEW PAT^^0
"BLD",10189,"KRN",101,"NM",10,0)
PSO PATIENT MED PAT BILL^^0
"BLD",10189,"KRN",101,"NM",11,0)
PSO PAT MED PAT INQ^^0
"BLD",10189,"KRN",101,"NM","B","PSO PAT MED PAT INQ",11)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED ACC PRO",2)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED BILL PRO",3)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED CANCEL",6)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED EXPORT",8)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED NEW PAT",9)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED PAT BILL",10)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED RESET",7)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MED TPJI",5)

"BLD",10189,"KRN",101,"NM","B","PSO PATIENT MEDICATION MENU",1)

"BLD",10189,"KRN",409.61,0)
409.61
"BLD",10189,"KRN",409.61,"NM",0)
^9.68A^1^1
"BLD",10189,"KRN",409.61,"NM",1,0)
PSO PATIENT MEDICATION LIST^^0
"BLD",10189,"KRN",409.61,"NM","B","PSO PATIENT MEDICATION LIST",1)

"BLD",10189,"KRN",771,0)
771
"BLD",10189,"KRN",779.2,0)
779.2
"BLD",10189,"KRN",870,0)
870
"BLD",10189,"KRN",8989.51,0)
8989.51
"BLD",10189,"KRN",8989.52,0)
8989.52
"BLD",10189,"KRN",8994,0)
8994
"BLD",10189,"KRN","B",.4,.4)

"BLD",10189,"KRN","B",.401,.401)

"BLD",10189,"KRN","B",.402,.402)

"BLD",10189,"KRN","B",.403,.403)

"BLD",10189,"KRN","B",.5,.5)

"BLD",10189,"KRN","B",.84,.84)

"BLD",10189,"KRN","B",3.6,3.6)

"BLD",10189,"KRN","B",3.8,3.8)

"BLD",10189,"KRN","B",9.2,9.2)

"BLD",10189,"KRN","B",9.8,9.8)

"BLD",10189,"KRN","B",19,19)

"BLD",10189,"KRN","B",19.1,19.1)

"BLD",10189,"KRN","B",101,101)

"BLD",10189,"KRN","B",409.61,409.61)

"BLD",10189,"KRN","B",771,771)

"BLD",10189,"KRN","B",779.2,779.2)

"BLD",10189,"KRN","B",870,870)

"BLD",10189,"KRN","B",8989.51,8989.51)

"BLD",10189,"KRN","B",8989.52,8989.52)

"BLD",10189,"KRN","B",8994,8994)

"BLD",10189,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",10189,"QUES",0)
^9.62^^
"BLD",10189,"REQB",0)
^9.611^2^2
"BLD",10189,"REQB",1,0)
PSO*7.0*476^1
"BLD",10189,"REQB",2,0)
PSN*4.0*492^1
"BLD",10189,"REQB","B","PSN*4.0*492",2)

"BLD",10189,"REQB","B","PSO*7.0*476",1)

"KRN",19,3345,-1)
2^2
"KRN",19,3345,0)
PSOCP MENU^Copay Menu^^M^1^^^^^^^60^^1
"KRN",19,3345,10,0)
^19.01IP^5^4
"KRN",19,3345,10,5,0)
11652
"KRN",19,3345,10,5,"^")
PSOCP RESET COPAY STATUS LM
"KRN",19,3345,"U")
COPAY MENU
"KRN",19,11652,-1)
0^3
"KRN",19,11652,0)
PSOCP RESET COPAY STATUS LM^Reset Copay Status List Manager^^R^^^^^^^^OUTPATIENT PHARMACY
"KRN",19,11652,1,0)
^^2^2^3160901^
"KRN",19,11652,1,1,0)
This list manager will allow the users to reset pharmacy copay status and 
"KRN",19,11652,1,2,0)
to cancel copay charges easier.
"KRN",19,11652,25)
EN^PSOCPF
"KRN",19,11652,"U")
RESET COPAY STATUS LIST MANAGE
"KRN",101,4763,-1)
0^1
"KRN",101,4763,0)
PSO PATIENT MEDICATION MENU^PSOCP MEDICATION COPAY LM^^M^^^^^^^^OUTPATIENT PHARMACY
"KRN",101,4763,4)
26^3
"KRN",101,4763,10,0)
^101.01PA^10^9
"KRN",101,4763,10,1,0)
4764^RC^11^^^Reset/Cancel
"KRN",101,4763,10,1,"^")
PSO PATIENT MED RESET
"KRN",101,4763,10,3,0)
4766^EC^13^^^Excel Report
"KRN",101,4763,10,3,"^")
PSO PATIENT MED EXPORT
"KRN",101,4763,10,4,0)
4959^AP^21^^^Account Profile
"KRN",101,4763,10,4,"^")
PSO PATIENT MED ACC PRO
"KRN",101,4763,10,5,0)
4960^PB^22^^^Bill Inquiry
"KRN",101,4763,10,5,"^")
PSO PATIENT MED PAT BILL
"KRN",101,4763,10,6,0)
4961^TP^32^^^Third Party Inq.
"KRN",101,4763,10,6,"^")
PSO PATIENT MED TPJI
"KRN",101,4763,10,7,0)
4962^PI^23^^^Patient Inquiry
"KRN",101,4763,10,7,"^")
PSO PAT MED PAT INQ
"KRN",101,4763,10,8,0)
4963^BP^31^^^Bill Profile
"KRN",101,4763,10,8,"^")
PSO PATIENT MED BILL PRO
"KRN",101,4763,10,9,0)
4995^CP^33^^^Change Patient
"KRN",101,4763,10,9,"^")
PSO PATIENT MED NEW PAT
"KRN",101,4763,10,10,0)
4765^CA^12^^^Cancel Charge
"KRN",101,4763,10,10,"^")
PSO PATIENT MED CANCEL
"KRN",101,4763,26)
D SHOW^VALM
"KRN",101,4763,28)
Select Action:
"KRN",101,4763,99)
64419,52057
"KRN",101,4764,-1)
0^7
"KRN",101,4764,0)
PSO PATIENT MED RESET^PSO PATIENT MED RESET^^A^^^^^^^^OUTPATIENT PHARMACY
"KRN",101,4764,20)
D RESET^PSOCPF1
"KRN",101,4764,99)
64363,61074
"KRN",101,4765,-1)
0^6
"KRN",101,4765,0)
PSO PATIENT MED CANCEL^PSO PATIENT MED CANCEL CHARGE^^A^^^^^^^^
"KRN",101,4765,20)
D CANCEL^PSOCPF1
"KRN",101,4765,99)
64363,61074
"KRN",101,4766,-1)
0^8
"KRN",101,4766,0)
PSO PATIENT MED EXPORT^PSO PATIENT MED EXCEL REPORT^^A^^^^^^^^
"KRN",101,4766,20)
D EXPORT^PSOCPF1
"KRN",101,4766,99)
64363,61074
"KRN",101,4959,-1)
0^2
"KRN",101,4959,0)
PSO PATIENT MED ACC PRO^PSO PATIENT ACCOUNT PROFILE^^A^^^^^^^^OUTPATIENT PHARMACY
"KRN",101,4959,2,0)
^101.02A^^0
"KRN",101,4959,20)
D PATACP^PSOCPF2
"KRN",101,4959,99)
64363,61074
"KRN",101,4960,-1)
0^10
"KRN",101,4960,0)
PSO PATIENT MED PAT BILL^PSO PATIENT PATIENT BILL INQ^^A^^^^^^^^
"KRN",101,4960,2,0)
^101.02A^^0
"KRN",101,4960,20)
D BILINQ^PSOCPF2
"KRN",101,4960,99)
64363,61074
"KRN",101,4961,-1)
0^5
"KRN",101,4961,0)
PSO PATIENT MED TPJI^PSO PATIENT MED TPJI^^A^^^^^^^^OUTPATIENT PHARMACY
"KRN",101,4961,2,0)
^101.02A^^0
"KRN",101,4961,20)
D TPJI^PSOCPF2
"KRN",101,4961,99)
64363,61074
"KRN",101,4962,-1)
0^11
"KRN",101,4962,0)
PSO PAT MED PAT INQ^PSO PATIENT MED INQUIRY^^A^^^^^^^^OUTPATIENT PHARMACY
"KRN",101,4962,2,0)
^101.02A^^0
"KRN",101,4962,20)
D PATINQ^PSOCPF2
"KRN",101,4962,99)
64363,61074
"KRN",101,4963,-1)
0^3
"KRN",101,4963,0)
PSO PATIENT MED BILL PRO^PSO PATIENT BILL PROFILE^^A^^^^^^^^OUTPATIENT PHARMACY
"KRN",101,4963,20)
D BILPRO^PSOCPF2
"KRN",101,4963,99)
64363,61074
"KRN",101,4995,-1)
0^9
"KRN",101,4995,0)
PSO PATIENT MED NEW PAT^NEW PATIENT^^A^^^^^^^^
"KRN",101,4995,20)
D NP^PSOCPF2
"KRN",101,4995,99)
64363,61074
"KRN",409.61,717,-1)
0^1
"KRN",409.61,717,0)
PSO PATIENT MEDICATION LIST^1^^80^3^18^1^1^^PSO PATIENT MEDICATION MENU^Patient Medications^1^^
"KRN",409.61,717,1)
^PSO HIDDEN ACTIONS #5
"KRN",409.61,717,"COL",0)
^409.621^6^6
"KRN",409.61,717,"COL",1,0)
LINE^1^4^^^0
"KRN",409.61,717,"COL",2,0)
NAME^6^27^Patient Name^^0
"KRN",409.61,717,"COL",3,0)
PID^29^5^ID^^0
"KRN",409.61,717,"COL",4,0)
MED^36^26^Medication^^0
"KRN",409.61,717,"COL",5,0)
FLDT^54^8^Fill DT^^0
"KRN",409.61,717,"COL",6,0)
STAT^63^15^Status^^0
"KRN",409.61,717,"COL","AIDENT",0,1)

"KRN",409.61,717,"COL","AIDENT",0,2)

"KRN",409.61,717,"COL","AIDENT",0,3)

"KRN",409.61,717,"COL","AIDENT",0,4)

"KRN",409.61,717,"COL","AIDENT",0,5)

"KRN",409.61,717,"COL","AIDENT",0,6)

"KRN",409.61,717,"COL","B","FLDT",5)

"KRN",409.61,717,"COL","B","LINE",1)

"KRN",409.61,717,"COL","B","MED",4)

"KRN",409.61,717,"COL","B","NAME",2)

"KRN",409.61,717,"COL","B","PID",3)

"KRN",409.61,717,"COL","B","STAT",6)

"KRN",409.61,717,"FNL")
D EXIT^PSOCPF
"KRN",409.61,717,"HDR")
D HDR^PSOCPF
"KRN",409.61,717,"HLP")
D HELP^PSOCPF
"KRN",409.61,717,"INIT")
D INIT^PSOCPF
"MBREQ")
0
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",17,409.61)
409.61;17;1;;;;LME1^XPDIA1;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",60,-1)
1^1
"PKG",60,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",60,20,0)
^9.402P^^
"PKG",60,22,0)
^9.49I^1^1
"PKG",60,22,1,0)
7.0^3051119^2990416^1
"PKG",60,22,1,"PAH",1,0)
463^3180117
"PKG",60,22,1,"PAH",1,1,0)
^^319^319^3170913
"PKG",60,22,1,"PAH",1,1,1,0)
IMPORTANT INSTALLATION NOTE:
"PKG",60,22,1,"PAH",1,1,2,0)
----------------------------
"PKG",60,22,1,"PAH",1,1,3,0)
This patch is part of a multi-package build. There are three patches
"PKG",60,22,1,"PAH",1,1,4,0)
associated with the FY16 HAPE Revenue Enhancement project - IB*2.0*568,
"PKG",60,22,1,"PAH",1,1,5,0)
PRCA*4.5*315 and PSO*7.0*463. All three patches are to be installed
"PKG",60,22,1,"PAH",1,1,6,0)
together as a bundle, IB_2_568_PRCA_PSO_BUNDLE_T1.KID
"PKG",60,22,1,"PAH",1,1,7,0)
 
"PKG",60,22,1,"PAH",1,1,8,0)
 
"PKG",60,22,1,"PAH",1,1,9,0)
Description
"PKG",60,22,1,"PAH",1,1,10,0)
-----------
"PKG",60,22,1,"PAH",1,1,11,0)
The Chief Business Office (CBO) is requesting system enhancements to
"PKG",60,22,1,"PAH",1,1,12,0)
The Veterans Health Information Systems and Technology Architecture
"PKG",60,22,1,"PAH",1,1,13,0)
(VistA) Integrated Billing (IB), Accounts Receivable (AR), and
"PKG",60,22,1,"PAH",1,1,14,0)
Outpatient Pharmacy (PSO) software modules.
"PKG",60,22,1,"PAH",1,1,15,0)
 
"PKG",60,22,1,"PAH",1,1,16,0)
The mission of the Department of Veterans Affairs (VA), Office of
"PKG",60,22,1,"PAH",1,1,17,0)
Information & Technology (OI&T), is to provide benefits and services to
"PKG",60,22,1,"PAH",1,1,18,0)
veterans of the United States Armed Forces. In meeting these goals,
"PKG",60,22,1,"PAH",1,1,19,0)
OIT strives to provide high quality, effective, and efficient
"PKG",60,22,1,"PAH",1,1,20,0)
Information Technology (IT) services to those responsible for providing
"PKG",60,22,1,"PAH",1,1,21,0)
care to the veterans at the point-of-care, as well as throughout all
"PKG",60,22,1,"PAH",1,1,22,0)
the points of the veterans' health care. The VA depends on 
"PKG",60,22,1,"PAH",1,1,23,0)
InformationManagement/Information Technology (IM/IT) systems to meet 
"PKG",60,22,1,"PAH",1,1,24,0)
mission
"PKG",60,22,1,"PAH",1,1,25,0)
goals.
"PKG",60,22,1,"PAH",1,1,26,0)
 
"PKG",60,22,1,"PAH",1,1,27,0)
The overall FY16 HAPE Revenue Enhancement project has been further
"PKG",60,22,1,"PAH",1,1,28,0)
divided into three sub-projects:
"PKG",60,22,1,"PAH",1,1,29,0)
 
"PKG",60,22,1,"PAH",1,1,30,0)
NSR #20150506
"PKG",60,22,1,"PAH",1,1,31,0)
The Revenue Eligibility Enhancements Project effort for the Chief
"PKG",60,22,1,"PAH",1,1,32,0)
Business Office (CBO), bundles several NSRs with similar business
"PKG",60,22,1,"PAH",1,1,33,0)
needs into a single requirements document.  Successfully addressing
"PKG",60,22,1,"PAH",1,1,34,0)
the requirements contained within this document will enable the
"PKG",60,22,1,"PAH",1,1,35,0)
Department of Veterans Affairs (VA) to appropriately bill certain
"PKG",60,22,1,"PAH",1,1,36,0)
subsets of billable events by correcting, automating, or enhancing
"PKG",60,22,1,"PAH",1,1,37,0)
current Veterans Health Information Systems and Technology
"PKG",60,22,1,"PAH",1,1,38,0)
Architecture (VistA) systems.
"PKG",60,22,1,"PAH",1,1,39,0)
 
"PKG",60,22,1,"PAH",1,1,40,0)
NSR #20150507
"PKG",60,22,1,"PAH",1,1,41,0)
The Revenue Operations Enhancements Project combines several NSRs, as
"PKG",60,22,1,"PAH",1,1,42,0)
well. This effort enables the Department of Veterans Affairs (VA) to
"PKG",60,22,1,"PAH",1,1,43,0)
improve revenue operation functionality related to repayment plans,
"PKG",60,22,1,"PAH",1,1,44,0)
late charge capture, bill suspension reasons, the billing of
"PKG",60,22,1,"PAH",1,1,45,0)
deactivated providers, and the display of appeal rights and
"PKG",60,22,1,"PAH",1,1,46,0)
responsibilities on the Veterans Beneficiary travel Bill of 
"PKG",60,22,1,"PAH",1,1,47,0)
Collectionsform.  Implementation of the proposed enhancements will make a
"PKG",60,22,1,"PAH",1,1,48,0)
significant positive impact on stakeholders and target users.
"PKG",60,22,1,"PAH",1,1,49,0)
 
"PKG",60,22,1,"PAH",1,1,50,0)
NSR #20150505
"PKG",60,22,1,"PAH",1,1,51,0)
The Revenue Reporting Enhancements Project will enable the VA to
"PKG",60,22,1,"PAH",1,1,52,0)
improve tracking and reporting of revenue, and will support 
"PKG",60,22,1,"PAH",1,1,53,0)
revenuereporting business rules and guidelines.
"PKG",60,22,1,"PAH",1,1,54,0)
 
"PKG",60,22,1,"PAH",1,1,55,0)
 
"PKG",60,22,1,"PAH",1,1,56,0)
PSO*7.0*463 patch enhancements, pertinent to the above NSRs, include:
"PKG",60,22,1,"PAH",1,1,57,0)
 
"PKG",60,22,1,"PAH",1,1,58,0)
1.) In the event of a Prescription Reset Status/Cancel Charges action,
"PKG",60,22,1,"PAH",1,1,59,0)
all automatic prepayment generation shall be
"PKG",60,22,1,"PAH",1,1,60,0)
eliminated.
"PKG",60,22,1,"PAH",1,1,61,0)
 
"PKG",60,22,1,"PAH",1,1,62,0)
2.) All "credit balances" that are automatically generated in the event
"PKG",60,22,1,"PAH",1,1,63,0)
of a Prescription Reset Status/Cancel Charges action exemption to stop.
"PKG",60,22,1,"PAH",1,1,64,0)
 
"PKG",60,22,1,"PAH",1,1,65,0)
3.) A new on-demand List Manager report will be made available for
"PKG",60,22,1,"PAH",1,1,66,0)
identification of Prescription resets.
"PKG",60,22,1,"PAH",1,1,67,0)
 4.) The new on-demand report for processing Prescription Resets 
"PKG",60,22,1,"PAH",1,1,68,0)
willprovide an option to generate a Summary Report and/or Detailed Report.
"PKG",60,22,1,"PAH",1,1,69,0)
 
"PKG",60,22,1,"PAH",1,1,70,0)
 
"PKG",60,22,1,"PAH",1,1,71,0)
 
"PKG",60,22,1,"PAH",1,1,72,0)
Associated Patches:
"PKG",60,22,1,"PAH",1,1,73,0)
-------------------
"PKG",60,22,1,"PAH",1,1,74,0)
IB*2.0*568
"PKG",60,22,1,"PAH",1,1,75,0)
PRCA*4.5*315
"PKG",60,22,1,"PAH",1,1,76,0)
 
"PKG",60,22,1,"PAH",1,1,77,0)
Concurrent Development / Dependencies:
"PKG",60,22,1,"PAH",1,1,78,0)
--------------------------------------
"PKG",60,22,1,"PAH",1,1,79,0)
N/A
"PKG",60,22,1,"PAH",1,1,80,0)
 
"PKG",60,22,1,"PAH",1,1,81,0)
Category
"PKG",60,22,1,"PAH",1,1,82,0)
--------
"PKG",60,22,1,"PAH",1,1,83,0)
Routine
"PKG",60,22,1,"PAH",1,1,84,0)
Template
"PKG",60,22,1,"PAH",1,1,85,0)
Other
"PKG",60,22,1,"PAH",1,1,86,0)
 
"PKG",60,22,1,"PAH",1,1,87,0)
 
"PKG",60,22,1,"PAH",1,1,88,0)
Patch Components:
"PKG",60,22,1,"PAH",1,1,89,0)
----------------- 
"PKG",60,22,1,"PAH",1,1,90,0)
Files & Fields Associated:
"PKG",60,22,1,"PAH",1,1,91,0)
 
"PKG",60,22,1,"PAH",1,1,92,0)
File Name (Number)    Field Name (Number)     New/Modified/Deleted
"PKG",60,22,1,"PAH",1,1,93,0)
------------------    -------------------     --------------------
"PKG",60,22,1,"PAH",1,1,94,0)
N/A
"PKG",60,22,1,"PAH",1,1,95,0)
 
"PKG",60,22,1,"PAH",1,1,96,0)
Options Associated:
"PKG",60,22,1,"PAH",1,1,97,0)
 
"PKG",60,22,1,"PAH",1,1,98,0)
Option Name                     Type          New/Modified/Deleted
"PKG",60,22,1,"PAH",1,1,99,0)
-----------                     ----          --------------------PSOCP 
"PKG",60,22,1,"PAH",1,1,100,0)
RESET COPAY STATUS LM     ROUTINE       NEW
"PKG",60,22,1,"PAH",1,1,101,0)
  
"PKG",60,22,1,"PAH",1,1,102,0)
Protocols Associated:
"PKG",60,22,1,"PAH",1,1,103,0)
 
"PKG",60,22,1,"PAH",1,1,104,0)
Protocol Name                   New/Modified/Deleted    Action
"PKG",60,22,1,"PAH",1,1,105,0)
-------------                   --------------------    ------
"PKG",60,22,1,"PAH",1,1,106,0)
PSO PATIENT MED ACC PRO         NEW
"PKG",60,22,1,"PAH",1,1,107,0)
PSO PATIENT MED BILL PRO        NEW
"PKG",60,22,1,"PAH",1,1,108,0)
PSO PATIENT MED CANCEL          NEW
"PKG",60,22,1,"PAH",1,1,109,0)
PSO PATIENT MED EXPORT          NEW
"PKG",60,22,1,"PAH",1,1,110,0)
PSO PATIENT MED PAT INQ         NEW
"PKG",60,22,1,"PAH",1,1,111,0)
PSO PATIENT MED RESET           NEW
"PKG",60,22,1,"PAH",1,1,112,0)
PSO PATIENT MED TPJI            NEW
"PKG",60,22,1,"PAH",1,1,113,0)
PSO PATIENT MEDICATION MENU     MODIFIED
"PKG",60,22,1,"PAH",1,1,114,0)
 
"PKG",60,22,1,"PAH",1,1,115,0)
Templates Associated:
"PKG",60,22,1,"PAH",1,1,116,0)
 
"PKG",60,22,1,"PAH",1,1,117,0)
Template Name                 Type   File Name (Number)      
"PKG",60,22,1,"PAH",1,1,118,0)
New/Mod/Del-------------                 ----   ------------------      
"PKG",60,22,1,"PAH",1,1,119,0)
-----------
"PKG",60,22,1,"PAH",1,1,120,0)
PSO PATIENT MEDICATION LIST   LIST   N/A                     NEW
"PKG",60,22,1,"PAH",1,1,121,0)
 
"PKG",60,22,1,"PAH",1,1,122,0)
New Service Requests (NSRs):----------------------------
"PKG",60,22,1,"PAH",1,1,123,0)
20150505 - Revenue Reporting Enhancements
"PKG",60,22,1,"PAH",1,1,124,0)
20150506 - Revenue Eligibility Enhancements
"PKG",60,22,1,"PAH",1,1,125,0)
20150507 - Revenue Operations Enhancements
"PKG",60,22,1,"PAH",1,1,126,0)
 
"PKG",60,22,1,"PAH",1,1,127,0)
 
"PKG",60,22,1,"PAH",1,1,128,0)
Patient Safety Issues (PSIs):
"PKG",60,22,1,"PAH",1,1,129,0)
------------------------------N/A
"PKG",60,22,1,"PAH",1,1,130,0)
 
"PKG",60,22,1,"PAH",1,1,131,0)
 
"PKG",60,22,1,"PAH",1,1,132,0)
Remedy Ticket(s) & Overviews:
"PKG",60,22,1,"PAH",1,1,133,0)
-----------------------------
"PKG",60,22,1,"PAH",1,1,134,0)
N/A
"PKG",60,22,1,"PAH",1,1,135,0)
 
"PKG",60,22,1,"PAH",1,1,136,0)
Test Sites:----------
"PKG",60,22,1,"PAH",1,1,137,0)
Durham VAMC
"PKG",60,22,1,"PAH",1,1,138,0)
 
"PKG",60,22,1,"PAH",1,1,139,0)
 
"PKG",60,22,1,"PAH",1,1,140,0)
Software and Documentation Retrieval Instructions:
"PKG",60,22,1,"PAH",1,1,141,0)
----------------------------------------------------
"PKG",60,22,1,"PAH",1,1,142,0)
Patches for this installation are combined in host file
"PKG",60,22,1,"PAH",1,1,143,0)
IB_2_568_PRCA_PSO_BUNDLE_T1.KID
"PKG",60,22,1,"PAH",1,1,144,0)
 
"PKG",60,22,1,"PAH",1,1,145,0)
Installation of this host file should be coordinated among the packages
"PKG",60,22,1,"PAH",1,1,146,0)
affected since only one installation is necessary.
"PKG",60,22,1,"PAH",1,1,147,0)
 
"PKG",60,22,1,"PAH",1,1,148,0)
The patches are:
"PKG",60,22,1,"PAH",1,1,149,0)
 
"PKG",60,22,1,"PAH",1,1,150,0)
     IB*2.0*568
"PKG",60,22,1,"PAH",1,1,151,0)
     PRCA*4.5*315
"PKG",60,22,1,"PAH",1,1,152,0)
     PSO*7.0*463
"PKG",60,22,1,"PAH",1,1,153,0)
 
"PKG",60,22,1,"PAH",1,1,154,0)
 Software and Documentation Retrieval Instructions
"PKG",60,22,1,"PAH",1,1,155,0)
-------------------------------------------------
"PKG",60,22,1,"PAH",1,1,156,0)
Software being released as a host file and/or documentation describingthe 
"PKG",60,22,1,"PAH",1,1,157,0)
new functionality introduced by these patches are available.
"PKG",60,22,1,"PAH",1,1,158,0)
  The preferred method is to retrieve files from 
"PKG",60,22,1,"PAH",1,1,159,0)
download.vista.domain.ext.
"PKG",60,22,1,"PAH",1,1,160,0)
This transmits the files from the first available server. Sites may 
"PKG",60,22,1,"PAH",1,1,161,0)
also elect to retrieve files directly from a specific server. 
"PKG",60,22,1,"PAH",1,1,162,0)
  
"PKG",60,22,1,"PAH",1,1,163,0)
Sites may retrieve the software and/or documentation directly using 
"PKG",60,22,1,"PAH",1,1,164,0)
Secure File Transfer Protocol (SFTP) from the ANONYMOUS.SOFTWARE 
"PKG",60,22,1,"PAH",1,1,165,0)
directory at the following OI Field Offices:
"PKG",60,22,1,"PAH",1,1,166,0)
 
"PKG",60,22,1,"PAH",1,1,167,0)
OI FIELD OFFICE     FTP ADDRESS                    DIRECTORY 
"PKG",60,22,1,"PAH",1,1,168,0)
---------------     --------------------       ------------------ 
"PKG",60,22,1,"PAH",1,1,169,0)
Albany:            domain.ext         
"PKG",60,22,1,"PAH",1,1,170,0)
Hines:             domain.ext                
"PKG",60,22,1,"PAH",1,1,171,0)
Salt Lake City:    domain.ext            
"PKG",60,22,1,"PAH",1,1,172,0)
  The host file is located in the  directory.
"PKG",60,22,1,"PAH",1,1,173,0)
        Use ASCII Mode when downloading the file.
"PKG",60,22,1,"PAH",1,1,174,0)
 
"PKG",60,22,1,"PAH",1,1,175,0)
Documentation can also be found on the VA Software Documentation Library 
"PKG",60,22,1,"PAH",1,1,176,0)
at: http://www4.domain.ext/vdl/
"PKG",60,22,1,"PAH",1,1,177,0)
 
"PKG",60,22,1,"PAH",1,1,178,0)
--------------------------------------------------------------------------
"PKG",60,22,1,"PAH",1,1,179,0)
Title                           File Name               FTP    Mode
"PKG",60,22,1,"PAH",1,1,180,0)
-------------------------------------------------------------------------
"PKG",60,22,1,"PAH",1,1,181,0)
Outpatient Pharmacy Technical
"PKG",60,22,1,"PAH",1,1,182,0)
   Manual/Security Guide         pso_7_ TM_R0417.PDF             binary
"PKG",60,22,1,"PAH",1,1,183,0)
Outpatient Pharmacy              
"PKG",60,22,1,"PAH",1,1,184,0)
  Back-out, and Rollback Guide    
"PKG",60,22,1,"PAH",1,1,185,0)
                           FY16RevenuePSOVIP_Deployment_Installation_Guide
"PKG",60,22,1,"PAH",1,1,186,0)
                                                                 binary
"PKG",60,22,1,"PAH",1,1,187,0)
 
"PKG",60,22,1,"PAH",1,1,188,0)
 Sites may retrieve documentation directly using Secure File 
"PKG",60,22,1,"PAH",1,1,189,0)
TransferProtocol (SFTP) from the ANONYMOUS.SOFTWARE directory at the 
"PKG",60,22,1,"PAH",1,1,190,0)
following
"PKG",60,22,1,"PAH",1,1,191,0)
OI Field Offices:
"PKG",60,22,1,"PAH",1,1,192,0)
 
"PKG",60,22,1,"PAH",1,1,193,0)
Albany:          domain.ext
"PKG",60,22,1,"PAH",1,1,194,0)
Hines:           domain.ext
"PKG",60,22,1,"PAH",1,1,195,0)
Salt Lake City:  domain.ext
"PKG",60,22,1,"PAH",1,1,196,0)
 
"PKG",60,22,1,"PAH",1,1,197,0)
Documentation can also be found on the VA Software Documentation Library
"PKG",60,22,1,"PAH",1,1,198,0)
at:
"PKG",60,22,1,"PAH",1,1,199,0)
http://www4.domain.ext/vdl/
"PKG",60,22,1,"PAH",1,1,200,0)
 
"PKG",60,22,1,"PAH",1,1,201,0)
Title                                             File Name  FTP Mode
"PKG",60,22,1,"PAH",1,1,202,0)
---------------------------------------------------------------------
"PKG",60,22,1,"PAH",1,1,203,0)
Outpatient Pharmacy Technical Manual/Security 
"PKG",60,22,1,"PAH",1,1,204,0)
Guide                                                  pso_7_tm.doc Binary
"PKG",60,22,1,"PAH",1,1,205,0)
Outpatient Pharmacy Deployment, Installation,
"PKG",60,22,1,"PAH",1,1,206,0)
     Back-Out, and Rollback Guide
"PKG",60,22,1,"PAH",1,1,207,0)
              FY16RevenuePSOVIP_Deployment_Installation_Guide.doc
"PKG",60,22,1,"PAH",1,1,208,0)
                                                               Binary
"PKG",60,22,1,"PAH",1,1,209,0)
 
"PKG",60,22,1,"PAH",1,1,210,0)
 
"PKG",60,22,1,"PAH",1,1,211,0)
 
"PKG",60,22,1,"PAH",1,1,212,0)
Patch Installation:
"PKG",60,22,1,"PAH",1,1,213,0)
 
"PKG",60,22,1,"PAH",1,1,214,0)
Pre/Post Installation Overview:
"PKG",60,22,1,"PAH",1,1,215,0)
-------------------------------
"PKG",60,22,1,"PAH",1,1,216,0)
N/A
"PKG",60,22,1,"PAH",1,1,217,0)
 
"PKG",60,22,1,"PAH",1,1,218,0)
Pre-Installation Instructions:
"PKG",60,22,1,"PAH",1,1,219,0)
------------------------------
"PKG",60,22,1,"PAH",1,1,220,0)
N/A
"PKG",60,22,1,"PAH",1,1,221,0)
 
"PKG",60,22,1,"PAH",1,1,222,0)
Installation Instructions:
"PKG",60,22,1,"PAH",1,1,223,0)
--------------------------
"PKG",60,22,1,"PAH",1,1,224,0)
This process will install new and updated routines and other
"PKG",60,22,1,"PAH",1,1,225,0)
components listed above. There is a post-install routine that will add
"PKG",60,22,1,"PAH",1,1,226,0)
entries to a number of files.
"PKG",60,22,1,"PAH",1,1,227,0)
 
"PKG",60,22,1,"PAH",1,1,228,0)
The patch will be released in conjunction with Integrated Billing
"PKG",60,22,1,"PAH",1,1,229,0)
patch, IB*4.5*568, and Accounts Receivable, PRCA*4.5*315.
"PKG",60,22,1,"PAH",1,1,230,0)
 
"PKG",60,22,1,"PAH",1,1,231,0)
  ************************ NOTE ************************
"PKG",60,22,1,"PAH",1,1,232,0)
  IF A USER IS ON THE SYSTEM AND USING THESE PROGRAMS
"PKG",60,22,1,"PAH",1,1,233,0)
  AN EDITED ERROR WILL OCCUR.
"PKG",60,22,1,"PAH",1,1,234,0)
  The patch should be installed when NO Outpatient
"PKG",60,22,1,"PAH",1,1,235,0)
  Pharmacy users are on the system.
"PKG",60,22,1,"PAH",1,1,236,0)
  ******************************************************
"PKG",60,22,1,"PAH",1,1,237,0)
 
"PKG",60,22,1,"PAH",1,1,238,0)
 Installation will take less than 1 minute.
"PKG",60,22,1,"PAH",1,1,239,0)
 
"PKG",60,22,1,"PAH",1,1,240,0)
 Suggested time to install: non-peak requirement hours.
"PKG",60,22,1,"PAH",1,1,241,0)
 
"PKG",60,22,1,"PAH",1,1,242,0)
 
"PKG",60,22,1,"PAH",1,1,243,0)
  1. Obtain the host file IB_2_568_PRCA_PSO_BUNDLE.KIDS which contains
"PKG",60,22,1,"PAH",1,1,244,0)
     the following patches:
"PKG",60,22,1,"PAH",1,1,245,0)
         IB*4.5*568
"PKG",60,22,1,"PAH",1,1,246,0)
         PRCA*4.5*315
"PKG",60,22,1,"PAH",1,1,247,0)
         PSO*7.0*463
"PKG",60,22,1,"PAH",1,1,248,0)
 
"PKG",60,22,1,"PAH",1,1,249,0)
  2. Startup KIDS
"PKG",60,22,1,"PAH",1,1,250,0)
     -------------     Start up the Kernel Installation and Distribution 
"PKG",60,22,1,"PAH",1,1,251,0)
System Menu option
"PKG",60,22,1,"PAH",1,1,252,0)
     [XPD MAIN]:
"PKG",60,22,1,"PAH",1,1,253,0)
  
"PKG",60,22,1,"PAH",1,1,254,0)
         Edits and Distribution ...
"PKG",60,22,1,"PAH",1,1,255,0)
         Utilities ...
"PKG",60,22,1,"PAH",1,1,256,0)
         Installation ...
"PKG",60,22,1,"PAH",1,1,257,0)
  
"PKG",60,22,1,"PAH",1,1,258,0)
     Select Kernel Installation & Distribution System Option: 
"PKG",60,22,1,"PAH",1,1,259,0)
INStallation                                                              
"PKG",60,22,1,"PAH",1,1,260,0)
---
"PKG",60,22,1,"PAH",1,1,261,0)
         Load a Distribution
"PKG",60,22,1,"PAH",1,1,262,0)
         Print Transport Global
"PKG",60,22,1,"PAH",1,1,263,0)
         Compare Transport Global to Current System
"PKG",60,22,1,"PAH",1,1,264,0)
         Verify Checksums in Transport Global
"PKG",60,22,1,"PAH",1,1,265,0)
         Install Package(s)
"PKG",60,22,1,"PAH",1,1,266,0)
         Restart Install of Package(s)
"PKG",60,22,1,"PAH",1,1,267,0)
         Unload a Distribution
"PKG",60,22,1,"PAH",1,1,268,0)
         Backup a Transport Global
"PKG",60,22,1,"PAH",1,1,269,0)
  
"PKG",60,22,1,"PAH",1,1,270,0)
     Select Installation Option: 
"PKG",60,22,1,"PAH",1,1,271,0)
 
"PKG",60,22,1,"PAH",1,1,272,0)
  3. LOAD TRANSPORT GLOBAL FOR MULTI-BUILD IB_2_568_PRCA_PSO_BUNDLE.KID
"PKG",60,22,1,"PAH",1,1,273,0)
     -------------------------------------------------------------
"PKG",60,22,1,"PAH",1,1,274,0)
     From the Installation menu, select the Load a Distribution option.
"PKG",60,22,1,"PAH",1,1,275,0)
  
"PKG",60,22,1,"PAH",1,1,276,0)
     When prompted for "Enter a Host File:", enter the full directory path
"PKG",60,22,1,"PAH",1,1,277,0)
     where you saved the host file IB_2_568_PRCA_PSO_BUNDLE.KID (e.g.,
"PKG",60,22,1,"PAH",1,1,278,0)
     SYS$SYSDEVICE:[ANONYMOUS] IB_2_568_PRCA_PSO_BUNDLE.KID).
"PKG",60,22,1,"PAH",1,1,279,0)
  
"PKG",60,22,1,"PAH",1,1,280,0)
     When prompted for "OK to continue with Load? NO//", enter "YES."  
"PKG",60,22,1,"PAH",1,1,281,0)
     The following will display:
"PKG",60,22,1,"PAH",1,1,282,0)
 
"PKG",60,22,1,"PAH",1,1,283,0)
     Loading Distribution...
"PKG",60,22,1,"PAH",1,1,284,0)
  
"PKG",60,22,1,"PAH",1,1,285,0)
         IB*2.0*568
"PKG",60,22,1,"PAH",1,1,286,0)
         PRCA*4.5*315
"PKG",60,22,1,"PAH",1,1,287,0)
         PSO*7.0*463
"PKG",60,22,1,"PAH",1,1,288,0)
  
"PKG",60,22,1,"PAH",1,1,289,0)
         Use INSTALL NAME: IB*2.0*568to install this
"PKG",60,22,1,"PAH",1,1,290,0)
         IB_2_568_PRCA_PSO_BUNDLE.KID distribution. 
"PKG",60,22,1,"PAH",1,1,291,0)
 
"PKG",60,22,1,"PAH",1,1,292,0)
  4. From this menu, you may select to use the following options
"PKG",60,22,1,"PAH",1,1,293,0)
     (when prompted for INSTALL NAME, enter IB*2.0*568):
"PKG",60,22,1,"PAH",1,1,294,0)
         a.  Verify Checksums in Transport Global - This option will
"PKG",60,22,1,"PAH",1,1,295,0)
             allow you to ensure the integrity of the routines that
"PKG",60,22,1,"PAH",1,1,296,0)
             are in the transport global.
"PKG",60,22,1,"PAH",1,1,297,0)
         b.  Print Transport Global - This option will allow you to
"PKG",60,22,1,"PAH",1,1,298,0)
             view the components of the KIDS build.
"PKG",60,22,1,"PAH",1,1,299,0)
         c.  Compare Transport Global to Current System - This 
"PKG",60,22,1,"PAH",1,1,300,0)
option             will allow you to view all changes that will be made 
"PKG",60,22,1,"PAH",1,1,301,0)
when
"PKG",60,22,1,"PAH",1,1,302,0)
             this patch is installed.  It compares all components of
"PKG",60,22,1,"PAH",1,1,303,0)
             this patch (routines, DD's, templates, etc.).
"PKG",60,22,1,"PAH",1,1,304,0)
         d.  Backup a Transport Global - This option will create a
"PKG",60,22,1,"PAH",1,1,305,0)
             backup message of any routines exported with this patch.
"PKG",60,22,1,"PAH",1,1,306,0)
             It will not backup any other changes such as DD's or
"PKG",60,22,1,"PAH",1,1,307,0)
             templates.
"PKG",60,22,1,"PAH",1,1,308,0)
 
"PKG",60,22,1,"PAH",1,1,309,0)
  5. When prompted "Want KIDS to INHIBIT LOGONs during the install?
"PKG",60,22,1,"PAH",1,1,310,0)
     NO//" respond NO.
"PKG",60,22,1,"PAH",1,1,311,0)
 
"PKG",60,22,1,"PAH",1,1,312,0)
  6. When prompted "Want to DISABLE Scheduled Options, Menu Options,
"PKG",60,22,1,"PAH",1,1,313,0)
     and Protocols? NO//" respond NO.
"PKG",60,22,1,"PAH",1,1,314,0)
 
"PKG",60,22,1,"PAH",1,1,315,0)
 
"PKG",60,22,1,"PAH",1,1,316,0)
 
"PKG",60,22,1,"PAH",1,1,317,0)
Post-Installation Instructions:
"PKG",60,22,1,"PAH",1,1,318,0)
-------------------------------
"PKG",60,22,1,"PAH",1,1,319,0)
There are no special tasks to perform after this patch installation.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PSOCPB")
0^1^B93273887^B94005590
"RTN","PSOCPB",1,0)
PSOCPB ;BIR/BaB - pharmacy co-pay application cont'd ;1/30/07 9:08am
"RTN","PSOCPB",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**72,71,85,185,143,219,239,201,263,303,431,476,463**;DEC 1997;Build 36
"RTN","PSOCPB",3,0)
 ;
"RTN","PSOCPB",4,0)
 ;REF/IA
"RTN","PSOCPB",5,0)
 ;DIS^SDROUT2/112
"RTN","PSOCPB",6,0)
 ;^IBARX/125
"RTN","PSOCPB",7,0)
 ;VADPT/10061
"RTN","PSOCPB",8,0)
 ;SWSTAT^IBBAPI/4663
"RTN","PSOCPB",9,0)
 ;Reference to $$CPTIER^PSNAPIS(P1,P3) supported by DBIA #2531
"RTN","PSOCPB",10,0)
COPAY ;
"RTN","PSOCPB",11,0)
 ;Called by PSON52,PSORN52...Requires PSOCPAY,PSOBILL,DEA=PSDEA,PSOFLAG
"RTN","PSOCPB",12,0)
 ;PSOFLAG=1 NEW, PSOFLAG=0 RENEW
"RTN","PSOCPB",13,0)
 S PSOSAVE=PSOCPAY ; Save original status of PSOCPAY
"RTN","PSOCPB",14,0)
 I '$G(PSOSCP)!('$G(PSOSCA)) D SCP^PSORN52D  ;CIDC-must ask sc if flagged for it in enrollment
"RTN","PSOCPB",15,0)
 I $G(PSODRUG("DEA"))["S"!($G(PSODRUG("DEA"))["I")!($G(PSODRUG("DEA"))["N") S PSOCPAY=0
"RTN","PSOCPB",16,0)
 G:+PSOBILL'=2&('$G(PSOSCA)) COPAY2
"RTN","PSOCPB",17,0)
 D FULL^VALM1
"RTN","PSOCPB",18,0)
 I $G(PSOMESOI)=1,$G(PSORXED) W !!,"The Pharmacy Orderable Item has changed for this order. Please review any",!,"existing SC or Environmental Indicator defaults carefully for appropriateness.",! S PSOMESOI=2
"RTN","PSOCPB",19,0)
 I $G(PSOMESFI)=1 W !!,"The Pharmacy Orderable Item has changed for this order. Please review any",!,"existing SC or Environmental Indicator defaults carefully for appropriateness.",! S PSOMESFI=2
"RTN","PSOCPB",20,0)
 S DFN=+$G(PSODFN) D CHKPAG^PSOMLLD2,DIS^SDROUT2
"RTN","PSOCPB",21,0)
ASK ;
"RTN","PSOCPB",22,0)
 N PSOUFLAG S PSOUFLAG=0
"RTN","PSOCPB",23,0)
 K PSOCPZ("DFLG"),PSONEW("NEWCOPAY")
"RTN","PSOCPB",24,0)
 W ! K DIR,DTOUT,DIRUT,DUOUT
"RTN","PSOCPB",25,0)
 I $G(PSORX("SC"))="SC"!($G(PSORX("SC"))="NSC")!($G(PSOSCOTH)) D
"RTN","PSOCPB",26,0)
 .W:PSOSCP<50&($G(PSODRUG("DEA"))'["S")&($G(PSODRUG("DEA"))'["I")&($G(PSODRUG("DEA"))'["N") !,"This Rx has been flagged by the provider as: "_$S($G(PSOSCOTH):"NO COPAY",$G(PSORX("SC"))="SC":"NO COPAY",1:"COPAY"),!
"RTN","PSOCPB",27,0)
 .I $G(PSOSCOTX) S PSOSCOTX=2
"RTN","PSOCPB",28,0)
 S DIR("A")="Was treatment for Service Connected condition",DIR(0)="Y"
"RTN","PSOCPB",29,0)
 S DIR("?")="Enter 'Yes' if this prescription is for a Service Connected condition"
"RTN","PSOCPB",30,0)
 I $G(PSORX("SC"))]""!($G(PSORX(+$G(PSORENW("OIRXN")),"SC"))'="") S DIR("B")=$S($G(PSORX("SC"))="SC":"YES",$G(PSORX("SC"))="NSC":"NO",$G(PSORX(+$G(PSORENW("OIRXN")),"SC"))=1:"YES",$G(PSORX(+$G(PSORENW("OIRXN")),"SC"))=0:"NO",1:"")
"RTN","PSOCPB",31,0)
 I $G(PSONEWFF),$G(PSOFLAG) I $G(PSOANSQD("SC"))=0!($G(PSOANSQD("SC"))=1) S DIR("B")=$S($G(PSOANSQD("SC"))=1:"YES",1:"NO")
"RTN","PSOCPB",32,0)
 I $G(DIR("B"))="YES"!($G(DIR("B"))="NO") S PSOUFLAG=$G(DIR("B"))
"RTN","PSOCPB",33,0)
 I $G(DIR("B"))="" K DIR("B")
"RTN","PSOCPB",34,0)
 D ^DIR
"RTN","PSOCPB",35,0)
 I $G(Y)=1!($G(Y)=0) S PSOANSQ("SC")=$G(Y) I $G(PSONEWFF),$G(PSOFLAG) S PSOANSQD("SC")=$G(Y)
"RTN","PSOCPB",36,0)
 I PSOFLAG I Y["^"!($D(DTOUT))!($D(DUOUT)) S PSOCPZ("DFLG")=1
"RTN","PSOCPB",37,0)
 S:Y=0 Y=2
"RTN","PSOCPB",38,0)
 S PSOANSR=+Y I 'PSOANSR,'PSOFLAG D  S $P(PSOCPAY,"^")=$S($G(PSOUFLAG)="NO":1,1:0) W ! K DIR S DIR(0)="E",DIR("A")="Press Return to continue" D ^DIR K DIR G COPAY2
"RTN","PSOCPB",39,0)
 .W !!,"This Renewal has been designated as "_$S($G(PSOUFLAG)="YES":"SERVICE CONNECTED",1:"NON-SERVICE CONNECTED.")
"RTN","PSOCPB",40,0)
 .W:PSOSCP<50&($G(PSODRUG("DEA"))'["S")&($G(PSODRUG("DEA"))'["I")&($G(PSODRUG("DEA"))'["N") !,"Please use the 'Reset Copay Status/Cancel Charges' option to make corrections."
"RTN","PSOCPB",41,0)
 .S PSOANSQ("SC")=$S($G(PSOUFLAG)="YES":1,1:0)
"RTN","PSOCPB",42,0)
 I $G(PSOFLAG),$G(PSOCPZ("DFLG")) G EXIT
"RTN","PSOCPB",43,0)
 S:PSOANSR=1 PSOCPAY=0 S:PSOANSR=2 $P(PSOCPAY,"^")=1
"RTN","PSOCPB",44,0)
COPAY2 ;
"RTN","PSOCPB",45,0)
 N PSOPFS S PSOPFS=$$SWSTAT^IBBAPI()
"RTN","PSOCPB",46,0)
 ;***** begin - for regression test FMCT - sites must not use this as it will adversely affect billing results - only used by SQA
"RTN","PSOCPB",47,0)
 ; The following is required for testing different effective dates.  If date is less than 02/27/17 bills old way.  Otherwise bills new way.
"RTN","PSOCPB",48,0)
 ;S ^XTMP("PSOTIEREFTST",0)="3201231^3170227^FOR SQA TESTING ONLY" - Defined for SQA testing only.   Delete this XTMP when regression complete
"RTN","PSOCPB",49,0)
 D NOW^%DTC N PSOTIERE
"RTN","PSOCPB",50,0)
 S PSOTIERE=1  ;use copay tiers - new
"RTN","PSOCPB",51,0)
 I $P(%,".")<3170227 S PSOTIERE=0  ;legacy billing - old
"RTN","PSOCPB",52,0)
 I $G(^XTMP("PSOTIEREFTST",0)) S PSOTIERE=1  ;for SQA testing only - bill with copay tiers - new
"RTN","PSOCPB",53,0)
 ;***** end for regression test
"RTN","PSOCPB",54,0)
 G COPAY21:'PSOTIERE
"RTN","PSOCPB",55,0)
 ;Check copay tier. Tier zero does not have copay charges. Tier billing will be effective 2/27/17 and IB rate table decides what amount to bill based on rate effective date
"RTN","PSOCPB",56,0)
 N CPDATE,X,PSOCPT D NOW^%DTC S CPDATE=X,PSOCPT=$$CPTIER^PSNAPIS("",CPDATE,PSODRUG("IEN")) K CPDATE,X
"RTN","PSOCPB",57,0)
 I $P(PSOCPT,"^")=0 S PSOCHG=0 K PSONEW("NEWCOPAY") G EXIT  ;Tier zero do not send to IB for copay charge
"RTN","PSOCPB",58,0)
 ;
"RTN","PSOCPB",59,0)
COPAY21 I +PSOCPAY=1,($P(PSOCPAY,"^",2)=1)!($P(PSOCPAY,"^",2)=2) D
"RTN","PSOCPB",60,0)
 .;set IB node in ^PSRX for copay if xactn type is 1 or 2
"RTN","PSOCPB",61,0)
 .S PSONEW("NEWCOPAY")=$P($G(PSOCPAY),"^",2)_"^^"_$S(+$G(PSOPFS):"",1:$P($G(PSOCPAY),"^",2))
"RTN","PSOCPB",62,0)
EXIT ;
"RTN","PSOCPB",63,0)
 S PSOCPAY=PSOSAVE ;Restore val of PSOCPAY
"RTN","PSOCPB",64,0)
 K PSOSAVE,PSOANSR,DIR,DUOUT,DIRUT,DTOUT,Y,X
"RTN","PSOCPB",65,0)
 Q
"RTN","PSOCPB",66,0)
RESET ;RESET COPAY STATUS
"RTN","PSOCPB",67,0)
 K PSOSUMM,PSOPFS,PSOPFSA,PSOLFIL,PSOPFSG
"RTN","PSOCPB",68,0)
 I '$D(PSOPAR) D ^PSOLSET G RESET
"RTN","PSOCPB",69,0)
 W ! S DIC="^PSRX(",DIC(0)="AEQZ" D ^DIC K DIC G:Y<0 EXT S PSODA=+Y
"RTN","PSOCPB",70,0)
 W !,?17,"PATIENT: ",$P($G(^DPT($P(^PSRX(PSODA,0),"^",2),0)),"^")
"RTN","PSOCPB",71,0)
 D ICN^PSODPT($P(^PSRX(PSODA,0),"^",2))
"RTN","PSOCPB",72,0)
 S PSORXN=$P(^PSRX(PSODA,0),"^"),PREA="R"
"RTN","PSOCPB",73,0)
 S PCOPAY=$G(^PSRX(PSODA,"IB"))
"RTN","PSOCPB",74,0)
 W !!,"Rx # ",PSORXN," is a ",$S(+PCOPAY:"Copay",1:"No Copay")," prescription"
"RTN","PSOCPB",75,0)
 S PSOLFIL=$$LF^PSOPFSU1(PSODA) D PFSA^PSOPFSU1(PSODA,PSOLFIL,3)  ;PSOCPC def PSOPFSA=1 if OP SC/EI's change.
"RTN","PSOCPB",76,0)
 D EXEMCHK^PSOCPC ; CHECK/CHANGE EXEMPTION FLAGS
"RTN","PSOCPB",77,0)
 S PSOIBQ=$G(^PSRX(PSODA,"IBQ"))
"RTN","PSOCPB",78,0)
 I '$G(^PSRX(PSODA,"IB")),PSOIBQ'["1" D  G ASKCAN
"RTN","PSOCPB",79,0)
 . K DIR S DIR(0)="Y",DIR("B")="N",DIR("A")="Do you want to reset the status to COPAY" D ^DIR K DIR
"RTN","PSOCPB",80,0)
 . I Y'=1 Q
"RTN","PSOCPB",81,0)
 . S DIC="^IBE(350.3,",DIC("S")="I $P(^(0),U,3)'=2",DIC(0)="AEQMZ",DIC("A")="Select Reason for Reset : " D ^DIC K DIC I Y'<0 S PSORSN=+Y
"RTN","PSOCPB",82,0)
 . S PREA="R",PSOOLD="No Copay",PSONW="Copay",PSOCOMM="" D ACTLOG^PSOCPA
"RTN","PSOCPB",83,0)
 . S PSI=0,PSOCOMM="Copay status of this Rx has been reset to COPAY." D SETSUMM^PSOCPC
"RTN","PSOCPB",84,0)
 . S $P(^PSRX(PSODA,"IB"),"^")=1 ;Reset flag to COPAY
"RTN","PSOCPB",85,0)
 ;
"RTN","PSOCPB",86,0)
 I $G(^PSRX(PSODA,"IB")) D  G ASKCAN
"RTN","PSOCPB",87,0)
 . K DIR S DIR(0)="Y",DIR("B")="N",DIR("A")="Do you want to reset the status to NO COPAYMENT" D ^DIR K DIR
"RTN","PSOCPB",88,0)
 . I Y'=1 Q
"RTN","PSOCPB",89,0)
 . S DIC="^IBE(350.3,",DIC("S")="I $P(^(0),U,3)'=2",DIC(0)="AEQMZ",DIC("A")="Select Reason for Reset : " D ^DIC K DIC I Y'<0 S PSORSN=+Y
"RTN","PSOCPB",90,0)
 . S PREA="R",PSOOLD="Copay",PSONW="No Copay",PSOCOMM="" D ACTLOG^PSOCPA
"RTN","PSOCPB",91,0)
 . S PSI=0,PSOCOMM="Copay status of this Rx has been reset to NO COPAY." D SETSUMM^PSOCPC
"RTN","PSOCPB",92,0)
 . S $P(^PSRX(PSODA,"IB"),"^")="" ;Reset flag to NO COPAY
"RTN","PSOCPB",93,0)
ASKCAN D ASKCAN^PSOCPD
"RTN","PSOCPB",94,0)
 I '$D(PSOSUMM) S PSI=0,PSOCOMM="No action taken" D SETSUMM^PSOCPC
"RTN","PSOCPB",95,0)
 D PRTSUMM
"RTN","PSOCPB",96,0)
 ;I $P($G(PSOPFS),"^",3)>0&(+$G(PSOPFSA)) D CHRG^PSOPFSU1(PSODA,PSOLFIL,"CG",PSOPFS)
"RTN","PSOCPB",97,0)
RESETE K PSODA,PSORXN,PSORSN,PSOREF,X,Y,PCOPAY,PREA,PSOCOMM,PSI
"RTN","PSOCPB",98,0)
 G RESET
"RTN","PSOCPB",99,0)
EXT K PSODA,PSORXN,PSORSN,PSOREF,X,Y,PCOPAY,PREA,PSOCOPAY
"RTN","PSOCPB",100,0)
 Q
"RTN","PSOCPB",101,0)
BILLED ;Collect IB nums,cancel chrgs,reset flag.
"RTN","PSOCPB",102,0)
 W !!,"**********Charges are on file for this Rx.**********"
"RTN","PSOCPB",103,0)
 Q
"RTN","PSOCPB",104,0)
BILL2 ;
"RTN","PSOCPB",105,0)
 N PSOPREV ; VAR FOR PREV CANCELLED
"RTN","PSOCPB",106,0)
 S PSOPREV=0
"RTN","PSOCPB",107,0)
 S DIC="^IBE(350.3,",DIC("S")="I $P(^(0),U,3)'=2",DIC(0)="AEQMZ",DIC("A")="Select Reason for Reset or Charge Cancellation : " D ^DIC K DIC G ENDMSG:Y<0 S PSORSN=+Y
"RTN","PSOCPB",108,0)
 S X=PSOPAR7_"^"_+$P(^PSRX(PSODA,0),"^",2)_"^^"_DUZ
"RTN","PSOCPB",109,0)
 S SAVX=X
"RTN","PSOCPB",110,0)
 I $D(PSOCAN) D:'$G(PSOPFS)  I +$G(PSOPFS)!($G(PSOPFSG)) D PFS^PSOPFSU1 G BILL2END:'$D(PSOCAN)
"RTN","PSOCPB",111,0)
 . N III S III="" F  S III=$O(PSOCAN(III)) Q:III=""  I PSOCAN(III)["PFS" S PSOPFSG=1 Q  ;PFSS switch off, check for prev cots billing
"RTN","PSOCPB",112,0)
 D POTBILL2
"RTN","PSOCPB",113,0)
 I '$D(PSOCAN) G BILL2END
"RTN","PSOCPB",114,0)
 I $G(CANTYPE) D PREVCAN I $O(X(""))="" Q
"RTN","PSOCPB",115,0)
 I '$G(CANTYPE) S I="" F  S I=$O(PSOCAN(I)) Q:I=""  S X($P(PSOCAN(I),"^",1))=$P(PSOCAN(I),"^",2)_"^"_PSORSN
"RTN","PSOCPB",116,0)
 D CANCEL^IBARX
"RTN","PSOCPB",117,0)
 I $G(CANTYPE) D MSG
"RTN","PSOCPB",118,0)
 I '$D(Y) Q
"RTN","PSOCPB",119,0)
 I +Y=-1 Q
"RTN","PSOCPB",120,0)
 I $D(Y(PSORXN)),+Y(PSORXN)'=-1 S $P(^PSRX(PSODA,"IB"),"^",2)=+Y(PSORXN) K Y(PSORXN) S PREA="C",PSOREF=0,PSOOLD="",PSONW="" D ACTLOG^PSOCPA I '$G(CANTYPE) D MSG
"RTN","PSOCPB",121,0)
 F PSOREF=0:0 S PSOREF=$O(Y(PSOREF)) Q:PSOREF=""  I +Y(PSOREF)'=-1 S ^PSRX(PSODA,1,PSOREF,"IB")=+Y(PSOREF) S PREA="C",PSOOLD="",PSONW="" D ACTLOG^PSOCPA I '$G(CANTYPE) D MSG
"RTN","PSOCPB",122,0)
BILL2END K X,Y,SAVX,PSOREF,PSOCAN
"RTN","PSOCPB",123,0)
 Q
"RTN","PSOCPB",124,0)
 ;
"RTN","PSOCPB",125,0)
POTBILL2 ;see if any potential charges (entries from file 354.71 -- bills that exceeded cap prev) to be cancelled before cancelling regular charges
"RTN","PSOCPB",126,0)
 N X,I
"RTN","PSOCPB",127,0)
 S X=SAVX
"RTN","PSOCPB",128,0)
 I $T(CANIBAM^IBARX)="" Q
"RTN","PSOCPB",129,0)
 S I="" F  S I=$O(PSOCAN(I)) Q:I=""  I PSOCAN(I)["^CAP" S X($P(PSOCAN(I),"^",1))=$P(PSOCAN(I),"^",2)_"^"_PSORSN K PSOCAN(I)
"RTN","PSOCPB",130,0)
 I $O(X(""))="" Q
"RTN","PSOCPB",131,0)
 S PSOPREV=1
"RTN","PSOCPB",132,0)
 D CANIBAM^IBARX
"RTN","PSOCPB",133,0)
 I $D(X(PSORXN)) S $P(^PSRX(PSODA,"IB"),"^",4)="" S PREA="C",PSOREF=0,PSOCOMM="Potential charge cancelled",PSOOLD="",PSONW="" D ACTLOG^PSOCPA D POTMSG K X(PSORXN)
"RTN","PSOCPB",134,0)
 F PSOREF=0:0 S PSOREF=$O(X(PSOREF)) Q:PSOREF=""  Q:PSOREF>11  S $P(^PSRX(PSODA,1,PSOREF,"IB"),"^",2)="" S PREA="C",PSOCOMM="Potential charge cancelled",PSOOLD="",PSONW="" D ACTLOG^PSOCPA D POTMSG
"RTN","PSOCPB",135,0)
 K PSOREF,PREA,PSOCOMM
"RTN","PSOCPB",136,0)
 Q
"RTN","PSOCPB",137,0)
REFILL S PSOREF=0
"RTN","PSOCPB",138,0)
 F  S PSOREF=$O(^PSRX(PSODA,1,PSOREF)) Q:PSOREF'?1N.N  D
"RTN","PSOCPB",139,0)
 . I $D(^PSRX(PSODA,1,PSOREF,"PFS")) S:$P($G(^PSRX(PSODA,1,PSOREF,"PFS")),"^",2) X(PSOREF)="^"_$G(PSORSN) Q
"RTN","PSOCPB",140,0)
 . I $D(^PSRX(PSODA,1,PSOREF,"IB")),+^("IB")>0 S X(PSOREF)=+^PSRX(PSODA,1,PSOREF,"IB")_"^"_$G(PSORSN)
"RTN","PSOCPB",141,0)
 S PSOREF=0 F  S PSOREF=$O(^PSRX(PSODA,1,PSOREF)) Q:PSOREF'?1N.N  I '$D(X(PSOREF)),+$P($G(^PSRX(PSODA,1,PSOREF,"IB")),"^",2) S XX(PSOREF)=+$P(^PSRX(PSODA,1,PSOREF,"IB"),"^",2)_"^"_$G(PSORSN) ; IF ONLY ENTRY FROM 354.71 SAVE IT
"RTN","PSOCPB",142,0)
 Q
"RTN","PSOCPB",143,0)
SETCP ;IF NOT COPAY MAKE ELIG CALL/SET FLAG FOR FUTURE
"RTN","PSOCPB",144,0)
 W ! S X=PSOPAR7_"^"_+$P(^PSRX(PSODA,0),"^",2)
"RTN","PSOCPB",145,0)
 D XTYPE^IBARX
"RTN","PSOCPB",146,0)
 I +Y=-1 W !!,"Error in processing Copay eligibility, no action taken." Q
"RTN","PSOCPB",147,0)
 S (ACTYP,BL)="",(PSOBILL,PSOCPAY)=0
"RTN","PSOCPB",148,0)
CP ;
"RTN","PSOCPB",149,0)
 S ACTYP=$O(Y(ACTYP)) G:'ACTYP CP1
"RTN","PSOCPB",150,0)
 F I=0:0 S BL=$O(Y(ACTYP,BL)) Q:BL=""  I BL>0 S PSOBILL=BL,PSOCPAY=ACTYP
"RTN","PSOCPB",151,0)
 G CP
"RTN","PSOCPB",152,0)
CP1 K ACTYP,BL,I
"RTN","PSOCPB",153,0)
 I (PSOBILL'>0)!(PSOCPAY=0) G INELIG
"RTN","PSOCPB",154,0)
 S $P(^PSRX(PSODA,"IB"),"^")=PSOCPAY
"RTN","PSOCPB",155,0)
 W !,"COPAY status on this Rx has been reset.",!,"*** Future refills will be classified as COPAY."
"RTN","PSOCPB",156,0)
 S PREA="R",PSOOLD="No Copay",PSONW="Copay"
"RTN","PSOCPB",157,0)
 D ACTLOG^PSOCPA
"RTN","PSOCPB",158,0)
 Q
"RTN","PSOCPB",159,0)
INELIG W !,"This Rx does not meet patient eligibility requirement for Copay.",!,"****** Status unchanged *******"
"RTN","PSOCPB",160,0)
 S Y=-1
"RTN","PSOCPB",161,0)
 Q
"RTN","PSOCPB",162,0)
ENDMSG K X W !,"Unable to process CHARGE REMOVAL without REASON for Reset."
"RTN","PSOCPB",163,0)
 R !,"ENTER a REASON now?  (Y/N) ",X:DTIME Q:'$T
"RTN","PSOCPB",164,0)
 I ($E(X)["?")!("YyNn^"'[$E(X)) W !,"Enter YES to select REASON and RESET STATUS." G ENDMSG
"RTN","PSOCPB",165,0)
 I "Yy"[$E(X) G BILL2
"RTN","PSOCPB",166,0)
 Q
"RTN","PSOCPB",167,0)
MSG ;
"RTN","PSOCPB",168,0)
 S PSI=0
"RTN","PSOCPB",169,0)
 I $G(CANTYPE) S PSOCOMM="Rx # "_PSORXN_" - All copay charges cancelled" D SETSUMM^PSOCPC K PSOCOMM Q
"RTN","PSOCPB",170,0)
 S PSOCOMM="Rx # "_PSORXN_" - "_$S(PSOREF=0:"Original fill",1:"Refill "_PSOREF)_" copay charge cancelled"
"RTN","PSOCPB",171,0)
 D SETSUMM^PSOCPC
"RTN","PSOCPB",172,0)
 K PSOCOMM
"RTN","PSOCPB",173,0)
 Q
"RTN","PSOCPB",174,0)
POTMSG ;
"RTN","PSOCPB",175,0)
 S PSI=0
"RTN","PSOCPB",176,0)
 I $G(CANTYPE) Q  ; (MESSAGE WILL GET SET LATER)
"RTN","PSOCPB",177,0)
 S PSOCOMM="Rx # "_PSORXN_" - "_$S(PSOREF=0:"Original fill",1:"Refill "_PSOREF)_" potential copay charge cancelled"
"RTN","PSOCPB",178,0)
 D SETSUMM^PSOCPC
"RTN","PSOCPB",179,0)
 K PSOCOMM
"RTN","PSOCPB",180,0)
 Q
"RTN","PSOCPB",181,0)
MSGNOCAN ;
"RTN","PSOCPB",182,0)
 S PSI=0
"RTN","PSOCPB",183,0)
 S PSOCOMM="Rx # "_PSORXN_" - All copay charges have already been cancelled." D SETSUMM^PSOCPC K PSOCOMM
"RTN","PSOCPB",184,0)
 Q
"RTN","PSOCPB",185,0)
 ;
"RTN","PSOCPB",186,0)
PRTSUMM ; prt sum of actions in reset/cancel
"RTN","PSOCPB",187,0)
 I '$D(PSOSUMM) Q
"RTN","PSOCPB",188,0)
 W !
"RTN","PSOCPB",189,0)
 S PSI=""
"RTN","PSOCPB",190,0)
 F  S PSI=$O(PSOSUMM(PSI)) Q:PSI=""  W !,PSOSUMM(PSI)
"RTN","PSOCPB",191,0)
 K PSOSUMM
"RTN","PSOCPB",192,0)
 Q
"RTN","PSOCPB",193,0)
PREVCAN ; PREVIEW CANCELS IF "ALL" IS SELECTED
"RTN","PSOCPB",194,0)
 N I,PSOBILL
"RTN","PSOCPB",195,0)
 S I="" F  S I=$O(PSOCAN(I)) Q:I=""  D  I PSOBILL S X($P(PSOCAN(I),"^",1))=$P(PSOCAN(I),"^",2)_"^"_PSORSN
"RTN","PSOCPB",196,0)
 . S PSOBILL=1 I $T(STATUS^IBARX)'="" I PSOCAN(I)'["CAP" S PSOBILL=$$STATUS^IBARX($P(PSOCAN(I),"^",2)) S:PSOBILL=2 PSOBILL=0 ; PREVIOUSLY CANCELLED
"RTN","PSOCPB",197,0)
 I $O(X(""))="" D
"RTN","PSOCPB",198,0)
 . I PSOPREV D MSG Q
"RTN","PSOCPB",199,0)
 . D MSGNOCAN
"RTN","PSOCPB",200,0)
 Q
"RTN","PSOCPB",201,0)
 ;
"RTN","PSOCPF")
0^2^B65916211^n/a
"RTN","PSOCPF",1,0)
PSOCPF ;BIR/BAA - Pharmacy CO-PAY Application Utilities for IB ;02/06/92
"RTN","PSOCPF",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**463**;DEC 1997;Build 36
"RTN","PSOCPF",3,0)
 ;
"RTN","PSOCPF",4,0)
EN ; -- main entry point for HELD CHARGES LIST
"RTN","PSOCPF",5,0)
 ;
"RTN","PSOCPF",6,0)
 ; add code to do filters here
"RTN","PSOCPF",7,0)
 N FILTERS,PNAME
"RTN","PSOCPF",8,0)
 I '$$FILTER(.FILTERS) Q
"RTN","PSOCPF",9,0)
 ;
"RTN","PSOCPF",10,0)
 ; code to do sort
"RTN","PSOCPF",11,0)
 D SORT
"RTN","PSOCPF",12,0)
 ;
"RTN","PSOCPF",13,0)
 K XQORS,VALMEVL D EN^VALM("PSO PATIENT MEDICATION LIST")
"RTN","PSOCPF",14,0)
 D ^%ZISC
"RTN","PSOCPF",15,0)
 Q
"RTN","PSOCPF",16,0)
 ;
"RTN","PSOCPF",17,0)
HDR ; -- header code
"RTN","PSOCPF",18,0)
 ;
"RTN","PSOCPF",19,0)
 S VALM("TITLE")=" Patient Medications "
"RTN","PSOCPF",20,0)
 Q
"RTN","PSOCPF",21,0)
 ;
"RTN","PSOCPF",22,0)
INIT ; -- init variables and list array
"RTN","PSOCPF",23,0)
 ; input - ^TMP($J,"PSOCPF")
"RTN","PSOCPF",24,0)
 ; output - ^TMP("VALMAR",$J)
"RTN","PSOCPF",25,0)
 N BDATE,EDATE,MEDSA,PAT,RXS
"RTN","PSOCPF",26,0)
 S BDATE=$P(FILTERS(0),U,1),EDATE=$P(FILTERS(0),U,2)
"RTN","PSOCPF",27,0)
 S RXS=$P(FILTERS(0),U,3),PAT=$P(FILTERS(0),U,4)
"RTN","PSOCPF",28,0)
 D BLD
"RTN","PSOCPF",29,0)
 Q
"RTN","PSOCPF",30,0)
 ;
"RTN","PSOCPF",31,0)
SORT ; get the data
"RTN","PSOCPF",32,0)
 N BDATE,EDATE,MEDS,PAT,RXS
"RTN","PSOCPF",33,0)
 S BDATE=$P(FILTERS(0),U,1),EDATE=$P(FILTERS(0),U,2)
"RTN","PSOCPF",34,0)
 S MEDS=$P(FILTERS(0),U,3),PAT=$P(FILTERS(0),U,4)
"RTN","PSOCPF",35,0)
 S RXS=$P(FILTERS(0),U,3)
"RTN","PSOCPF",36,0)
 S ^TMP($J,"PSOCPFF",0)=FILTERS(0)
"RTN","PSOCPF",37,0)
 ;
"RTN","PSOCPF",38,0)
 D SORT^PSOCPF1
"RTN","PSOCPF",39,0)
 Q
"RTN","PSOCPF",40,0)
 ;
"RTN","PSOCPF",41,0)
BLD ; build data to display
"RTN","PSOCPF",42,0)
 ; build display
"RTN","PSOCPF",43,0)
 ; ^TMP($J,"PSOCPF",PTNM,RIEN,RFL)=PTNM_U_PID_U_MED_U_RIEN_U_RFL_U_ARTRN_U_RX_U_FILDT_U_BLNO_U_ARST1_U_SC_U_SCP_U_MTSD_U_MTS_U_DFN_U_PBIL_U_ARST_U_PRIEN
"RTN","PSOCPF",44,0)
 K ^TMP($J,"PSOCPFX"),^TMP($J,"PSOCPFE")
"RTN","PSOCPF",45,0)
 K ^TMP("VALMAR",$J)
"RTN","PSOCPF",46,0)
 N LINE,VCNT
"RTN","PSOCPF",47,0)
 I '$D(^TMP($J,"PSOCPF")) D  Q
"RTN","PSOCPF",48,0)
 . S VCNT=1
"RTN","PSOCPF",49,0)
 . S LINE=$$SETL("","","",1,4)
"RTN","PSOCPF",50,0)
 . S LINE=$$SETL(LINE,"NO DATA FOUND FOR ENTERED CRITERIA","",5,50)
"RTN","PSOCPF",51,0)
 . S VALMCNT=1
"RTN","PSOCPF",52,0)
 . D SET^VALM10(VALMCNT,LINE,VCNT)
"RTN","PSOCPF",53,0)
 N RFL,VCNT,MED,NAME,RFL,SC,SCP,FILDT,BLN,IBST1,MTS,RX,REC,VALMY,ARST1,BLNO,CPY,CPYO
"RTN","PSOCPF",54,0)
 N DFN,MTO,MTSD,MTSO,PBIL,PID,PRIEN,RIEN,RXO,RXS,SCO,SCOO,SCPO,DEBTOR
"RTN","PSOCPF",55,0)
 S VALMCNT=0
"RTN","PSOCPF",56,0)
 S (RIEN,VCNT)=0,(NAME,RFL)=""
"RTN","PSOCPF",57,0)
 F  S NAME=$O(^TMP($J,"PSOCPF",NAME)) Q:NAME=""  D
"RTN","PSOCPF",58,0)
 . F  S RIEN=$O(^TMP($J,"PSOCPF",NAME,RIEN)) Q:RIEN=""  D
"RTN","PSOCPF",59,0)
 .. F  S RFL=$O(^TMP($J,"PSOCPF",NAME,RIEN,RFL)) Q:RFL=""  D
"RTN","PSOCPF",60,0)
 ... S VCNT=VCNT+1
"RTN","PSOCPF",61,0)
 ... S LINE=$$SETL("",VCNT,"",1,4) ;line#
"RTN","PSOCPF",62,0)
 ... S REC=^TMP($J,"PSOCPF",NAME,RIEN,RFL),PID=$P(REC,U,2),ARST1=$P(REC,U,10),PBIL=$P(REC,U,16)
"RTN","PSOCPF",63,0)
 ... S MED=$P(REC,U,3),RX=$P(REC,U,7),BLN=$P(REC,U,9),FILDT=$P(REC,U,8),DFN=$P(REC,U,15)
"RTN","PSOCPF",64,0)
 ... S PRIEN=$P(REC,U,18),CPY=$P(REC,U,20),DEBTOR=$P(REC,U,21)
"RTN","PSOCPF",65,0)
 ... S ^TMP($J,"PSOCPFX",VCNT)=NAME_U_DFN_U_MED_U_RIEN_U_BLN_U_PRIEN_U_RFL_U_RX_U_DEBTOR
"RTN","PSOCPF",66,0)
 ... I $D(^TMP($J,"PSOCPFC",NAME,RIEN,RFL)) S ARST1="CANCELLED CHARGE"
"RTN","PSOCPF",67,0)
 ... S RXO="Rx#:"_RX_"-"_RFL
"RTN","PSOCPF",68,0)
 ... S BLNO="BIL#:"_BLN
"RTN","PSOCPF",69,0)
 ... S SC=$P(REC,U,11),SCO=$S(SC=1:"YES",1:"NO"),SCOO="SC:"_SCO
"RTN","PSOCPF",70,0)
 ... S SCP=$P(REC,U,12),SCPO="SC%:"_+SCP
"RTN","PSOCPF",71,0)
 ... S MTSD=$P(REC,U,13),MTO="DT:"_MTSD
"RTN","PSOCPF",72,0)
 ... S MTS=$P(REC,U,14),MTSO="MT:"_MTS
"RTN","PSOCPF",73,0)
 ... S CPYO="RX:"_CPY
"RTN","PSOCPF",74,0)
 ... S ^TMP($J,"PSOCPFE",NAME,RIEN,RFL)=NAME_U_PID_U_MED_U_RX_"-"_RFL_U_$$FMTE^XLFDT(FILDT,"2DZ")_U_BLN_U_ARST1_U_SCO_U_SCP_"%"_U_MTS_U_MTSD_U_CPY
"RTN","PSOCPF",75,0)
 ... S LINE=$$SETL(LINE,NAME,"",5,22)
"RTN","PSOCPF",76,0)
 ... S LINE=$$SETL(LINE,PID,"",28,6)
"RTN","PSOCPF",77,0)
 ... S LINE=$$SETL(LINE,MED,"",35,16)
"RTN","PSOCPF",78,0)
 ... S LINE=$$SETL(LINE,$$FMTE^XLFDT(FILDT,"2DZ"),"",53,8)
"RTN","PSOCPF",79,0)
 ... S LINE=$$SETL(LINE,ARST1,"",62,17)
"RTN","PSOCPF",80,0)
 ... S VALMCNT=VALMCNT+1
"RTN","PSOCPF",81,0)
 ... D SET^VALM10(VALMCNT,LINE,VCNT)
"RTN","PSOCPF",82,0)
 ... S LINE=$$SETL("",SCOO,"",5,8)
"RTN","PSOCPF",83,0)
 ... S LINE=$$SETL(LINE,SCPO,"",14,8)
"RTN","PSOCPF",84,0)
 ... S LINE=$$SETL(LINE,RXO,"",35,20)
"RTN","PSOCPF",85,0)
 ... S LINE=$$SETL(LINE,BLNO,"",62,17)
"RTN","PSOCPF",86,0)
 ... S VALMCNT=VALMCNT+1
"RTN","PSOCPF",87,0)
 ... D SET^VALM10(VALMCNT,LINE,VCNT)
"RTN","PSOCPF",88,0)
 ... S LINE=$$SETL("",MTSO,"",5,20)
"RTN","PSOCPF",89,0)
 ... S LINE=$$SETL(LINE,MTO,"",35,16)
"RTN","PSOCPF",90,0)
 ... S LINE=$$SETL(LINE,CPYO,"",53,25)
"RTN","PSOCPF",91,0)
 ... S VALMCNT=VALMCNT+1
"RTN","PSOCPF",92,0)
 ... D SET^VALM10(VALMCNT,LINE,VCNT)
"RTN","PSOCPF",93,0)
 ... S LINE=""
"RTN","PSOCPF",94,0)
 ... S VALMCNT=VALMCNT+1
"RTN","PSOCPF",95,0)
 ... D SET^VALM10(VALMCNT,LINE,VCNT)
"RTN","PSOCPF",96,0)
 Q
"RTN","PSOCPF",97,0)
 ;
"RTN","PSOCPF",98,0)
SETL(LINE,DATA,LABEL,COL,LNG) ; Creates a line of data to be set into the body
"RTN","PSOCPF",99,0)
 ; of the worklist
"RTN","PSOCPF",100,0)
 ; Input: LINE - Current line being created
"RTN","PSOCPF",101,0)
 ; DATA - Information to be added to the end of the current line
"RTN","PSOCPF",102,0)
 ; LABEL - Label to describe the information being added
"RTN","PSOCPF",103,0)
 ; COL - Column position in line to add information add
"RTN","PSOCPF",104,0)
 ; LNG - Maximum length of data information to include on the line
"RTN","PSOCPF",105,0)
 ; Returns: Line updated with added information
"RTN","PSOCPF",106,0)
 S LINE=LINE_$J("",(COL-$L(LABEL)-$L(LINE)))_LABEL_$E(DATA,1,LNG)
"RTN","PSOCPF",107,0)
 Q LINE
"RTN","PSOCPF",108,0)
 ;
"RTN","PSOCPF",109,0)
HELP ; -- help code
"RTN","PSOCPF",110,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","PSOCPF",111,0)
 Q
"RTN","PSOCPF",112,0)
 ;
"RTN","PSOCPF",113,0)
EXIT ; -- exit code
"RTN","PSOCPF",114,0)
 K ^TMP($J,"PSOCPF")
"RTN","PSOCPF",115,0)
 K ^TMP($J,"PSOCPFX")
"RTN","PSOCPF",116,0)
 K ^TMP($J,"PSOCPFE")
"RTN","PSOCPF",117,0)
 K ^TMP($J,"PSOCPFC")
"RTN","PSOCPF",118,0)
 ;
"RTN","PSOCPF",119,0)
 D CLEAR^VALM1,CLEAN^VALM10
"RTN","PSOCPF",120,0)
 D ^%ZISC
"RTN","PSOCPF",121,0)
 Q
"RTN","PSOCPF",122,0)
 ;
"RTN","PSOCPF",123,0)
FILTER(FILTERS) ; filter display
"RTN","PSOCPF",124,0)
 ; Sets an array of filters to determine which entris to include in display
"RTN","PSOCPF",125,0)
 ; Input:   None
"RTN","PSOCPF",126,0)
 ; Output:  
"RTN","PSOCPF",127,0)
 ; Returns: 0 if the user entered '^' or timed out, 1 otherwise
"RTN","PSOCPF",128,0)
 ; FILTERS(0) = from date ^ to date ^ 0 (all) 1 (selected) prescriptions ^ patient ^
"RTN","PSOCPF",129,0)
 ;                                    0 (no) 1 (yes) exclued canceled bills
"RTN","PSOCPF",130,0)
 ; FILTERS(1,RX ien) = ""
"RTN","PSOCPF",131,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,XX,Y,IBDATES,DFN,R
"RTN","PSOCPF",132,0)
 K FILTERS
"RTN","PSOCPF",133,0)
 ;
"RTN","PSOCPF",134,0)
 S DIC(0)="AEQMN",DIC="^DPT(",FIRST=1
"RTN","PSOCPF",135,0)
 S PAT=$$ONEPAT()
"RTN","PSOCPF",136,0)
 I PAT=-1 Q 0
"RTN","PSOCPF",137,0)
 S PNAME=$P(PAT,U,2)
"RTN","PSOCPF",138,0)
 S (DFN,PAT,$P(FILTERS(0),U,4))=$P(PAT,U,1)
"RTN","PSOCPF",139,0)
 ;
"RTN","PSOCPF",140,0)
 ; get date range
"RTN","PSOCPF",141,0)
 S IBDATES="Fill Dates",IBDATES=$$FMDATES(IBDATES) I IBDATES=0 Q 0
"RTN","PSOCPF",142,0)
 S $P(FILTERS(0),U,1)=$P(IBDATES,U,1)
"RTN","PSOCPF",143,0)
 S $P(FILTERS(0),U,2)=$P(IBDATES,U,2)
"RTN","PSOCPF",144,0)
 ;
"RTN","PSOCPF",145,0)
 ; Prescription filter
"RTN","PSOCPF",146,0)
 D ADDRX
"RTN","PSOCPF",147,0)
 I Y=-1 Q 0
"RTN","PSOCPF",148,0)
 ;
"RTN","PSOCPF",149,0)
 S ^TMP($J,"PSOCPFF",0)=FILTERS(0)
"RTN","PSOCPF",150,0)
 S R=""
"RTN","PSOCPF",151,0)
 F  S R=$O(FILTERS(1,R)) Q:R=""  S ^TMP($J,"PSOCPFF",1,R)=FILTERS(1,R)
"RTN","PSOCPF",152,0)
 ;
"RTN","PSOCPF",153,0)
 D SHOWFILT(.FILTERS)
"RTN","PSOCPF",154,0)
 I X="^" Q 0
"RTN","PSOCPF",155,0)
 Q 1
"RTN","PSOCPF",156,0)
 ;
"RTN","PSOCPF",157,0)
ADDRX ; 
"RTN","PSOCPF",158,0)
 ; Prescription filter
"RTN","PSOCPF",159,0)
 S DIR(0)="S",DIR("A")="Select(A)ll or (S)elected Prescription(s)",DIR("B")="All"
"RTN","PSOCPF",160,0)
 S DIR("?",1)="Enter 'A' to not filter by Prescriptions."
"RTN","PSOCPF",161,0)
 S DIR("?")="Enter 'S' to view entries for selected Prescription(s)."
"RTN","PSOCPF",162,0)
 S $P(DIR(0),U,2)="A:All Prescriptions;S:Selected Prescriptions"
"RTN","PSOCPF",163,0)
 W ! D ^DIR K DIR
"RTN","PSOCPF",164,0)
 I Y=-1 Q 0
"RTN","PSOCPF",165,0)
 S X=$$UP^XLFSTR(X)
"RTN","PSOCPF",166,0)
 S $P(FILTERS(0),U,3)=$S(Y="A":0,1:1)
"RTN","PSOCPF",167,0)
 ;
"RTN","PSOCPF",168,0)
 I $P(FILTERS(0),U,3)=1 D ASKRX(.FILTERS)
"RTN","PSOCPF",169,0)
 ;
"RTN","PSOCPF",170,0)
 Q
"RTN","PSOCPF",171,0)
 ;
"RTN","PSOCPF",172,0)
FMDATES(PROMPT,SDT,EDT) ; ask for date range
"RTN","PSOCPF",173,0)
 N %DT,X,Y,DT1,DT2,IB0,IB1,IB2
"RTN","PSOCPF",174,0)
 S DT1="",IB1="Start with date entered: ",IB2="Go to date entered: "
"RTN","PSOCPF",175,0)
 I $G(PROMPT)'="" S IB1="Start with "_PROMPT_": ",IB2="Go to "_PROMPT_": "
"RTN","PSOCPF",176,0)
 I $D(SDT) K %DT S Y=SDT D DD^%DT S %DT("B")=Y
"RTN","PSOCPF",177,0)
 ;
"RTN","PSOCPF",178,0)
 S %DT="AEX",%DT("A")=IB1 D ^%DT K %DT I Y<0!($P(Y,".",1)'?7N) G FMDQ
"RTN","PSOCPF",179,0)
 S (%DT(0),DT2)=$P(Y,".",1) I DT2'>DT,'$D(EDT) S %DT("B")="Today"
"RTN","PSOCPF",180,0)
 ; 
"RTN","PSOCPF",181,0)
 I $D(EDT) K %DT S Y=EDT D DD^%DT S %DT("B")=Y
"RTN","PSOCPF",182,0)
 ;
"RTN","PSOCPF",183,0)
 S %DT="AEX",%DT("A")=IB2 D ^%DT K %DT I Y<0!($P(Y,".",1)'?7N) G FMDQ
"RTN","PSOCPF",184,0)
 S DT1=DT2_U_$P(Y,".",1)
"RTN","PSOCPF",185,0)
FMDQ Q DT1
"RTN","PSOCPF",186,0)
 ;
"RTN","PSOCPF",187,0)
ASKRX(FILTERS)   ; Sets a list of PrescriptionS to be displayed
"RTN","PSOCPF",188,0)
 ; Input:   FILTERS - Current Array of filter settings
"RTN","PSOCPF",189,0)
 ; Output:  FILTERS - Updated Array of filter settings
"RTN","PSOCPF",190,0)
 N DIC,DIR,DIRUT,DIVS,DUOUT,FIRST,PSOIENS,PSOIENS2,IEN,N,X,XX,Y
"RTN","PSOCPF",191,0)
 S DIC=52,DIC(0)="AEQMN",FIRST=1
"RTN","PSOCPF",192,0)
 K FILTERS(1)
"RTN","PSOCPF",193,0)
 F  D  Q:+IEN<1
"RTN","PSOCPF",194,0)
 . D ONERX(.DIC,.IEN,.FIRST)                   ; One Prescription prompt
"RTN","PSOCPF",195,0)
 . Q:+IEN<1
"RTN","PSOCPF",196,0)
 . S PSOIENS($P(IEN,U,2))=$P(IEN,U,1)
"RTN","PSOCPF",197,0)
 . S PSOIENS2($P(IEN,U,1))=$P(IEN,U,2)
"RTN","PSOCPF",198,0)
 I '$D(PSOIENS) S $P(FILTERS(0),U,3)=0 Q
"RTN","PSOCPF",199,0)
 ;
"RTN","PSOCPF",200,0)
 ; Set the filter node responses in alphabetical order
"RTN","PSOCPF",201,0)
 S XX=""
"RTN","PSOCPF",202,0)
 F  D  Q:XX=""
"RTN","PSOCPF",203,0)
 . S XX=$O(PSOIENS(XX))
"RTN","PSOCPF",204,0)
 . Q:XX=""
"RTN","PSOCPF",205,0)
 . S N=PSOIENS(XX)
"RTN","PSOCPF",206,0)
 . S FILTERS(1,N)=XX
"RTN","PSOCPF",207,0)
 Q
"RTN","PSOCPF",208,0)
 ;
"RTN","PSOCPF",209,0)
ONERX(DIC,IEN,FIRST)  ; Prompts the user for a Medication
"RTN","PSOCPF",210,0)
 ; Input:   DIC     - Variable/Array of settings needed for ^DIC call
"RTN","PSOCPF",211,0)
 ;          FIRST   - Set to 1 initially and then 0 for subsequent calls
"RTN","PSOCPF",212,0)
 ; Output:  FIRST   - Set to 0
"RTN","PSOCPF",213,0)
 ;          IEN     - IEN of the selected Division
"RTN","PSOCPF",214,0)
 ;                    null of no selection was made
"RTN","PSOCPF",215,0)
 S DIC("A")=$S(FIRST:"Select a Prescription: ",1:"Select Another Prescription: ")
"RTN","PSOCPF",216,0)
 D ^DIC
"RTN","PSOCPF",217,0)
 S FIRST=0,IEN=Y
"RTN","PSOCPF",218,0)
 Q
"RTN","PSOCPF",219,0)
 ;
"RTN","PSOCPF",220,0)
ONEPAT(DIC,IEN,FIRST)  ; Prompts the user for a clinic or ward
"RTN","PSOCPF",221,0)
 ; Input:   DIC     - Variable/Array of settings needed for ^DIC call
"RTN","PSOCPF",222,0)
 ;          FIRST   - Set to 1 initially and then 0 for subsequent calls
"RTN","PSOCPF",223,0)
 ; Output:  FIRST   - Set to 0
"RTN","PSOCPF",224,0)
 ;          IEN     - IEN of the selected Patient
"RTN","PSOCPF",225,0)
 ;                    null of no selection was made
"RTN","PSOCPF",226,0)
 N DPTNOFZY S DPTNOFZY=1  ;Suppress PATIENT file fuzzy lookups
"RTN","PSOCPF",227,0)
 S DIC(0)="AEQMN",DIC="^DPT("
"RTN","PSOCPF",228,0)
 S DIC("A")="Select Patient: "
"RTN","PSOCPF",229,0)
 D ^DIC
"RTN","PSOCPF",230,0)
 Q Y
"RTN","PSOCPF",231,0)
 ;
"RTN","PSOCPF",232,0)
 ;
"RTN","PSOCPF",233,0)
SHOWFILT(FILTERS)   ;EP
"RTN","PSOCPF",234,0)
 ; Displays the currently selected filter selections for the
"RTN","PSOCPF",235,0)
 ; Held Charges ListManager display
"RTN","PSOCPF",236,0)
 ; Input:   FILTERS()   - Array of filter settings. See FILTERS for a detailed
"RTN","PSOCPF",237,0)
 ;                        explanation of the FILTERS array
"RTN","PSOCPF",238,0)
 ; Output:  Current Filter settings are displayed
"RTN","PSOCPF",239,0)
 ;
"RTN","PSOCPF",240,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,IEN,IX,LEN,LINE,XX,PFLG,STDT,R,PAT,ENDT,STDT,I
"RTN","PSOCPF",241,0)
 ;
"RTN","PSOCPF",242,0)
 W !!,"Selected Patient: ",PNAME
"RTN","PSOCPF",243,0)
 ;
"RTN","PSOCPF",244,0)
 S STDT=$P(FILTERS(0),U),ENDT=$P(FILTERS(0),U,2)
"RTN","PSOCPF",245,0)
 W !,"Show From Date: ",$S(STDT=0:"First",1:$$FMTE^XLFDT(STDT,"2DZ"))
"RTN","PSOCPF",246,0)
 W !,"     Thru Date: ",$$FMTE^XLFDT(ENDT,"2DZ")
"RTN","PSOCPF",247,0)
 W !,"Show All Prescriptions or Selected Prescriptions: "
"RTN","PSOCPF",248,0)
 W $S($P(FILTERS(0),U,3)=0:"All",1:"Selected")
"RTN","PSOCPF",249,0)
 ;
"RTN","PSOCPF",250,0)
 ; RX list (if any)
"RTN","PSOCPF",251,0)
 I ($P(FILTERS(0),U,3)=1) D
"RTN","PSOCPF",252,0)
 . S LINE="Prescriptions to Display: "
"RTN","PSOCPF",253,0)
 . S IEN=0,PFLG=0
"RTN","PSOCPF",254,0)
 . F  S IEN=$O(FILTERS(1,IEN)) Q:IEN=""  D
"RTN","PSOCPF",255,0)
 . . S XX=FILTERS(1,IEN)
"RTN","PSOCPF",256,0)
 . . S LINE=LINE_$S(LINE="Prescriptions to Display: ":"",1:", ")_XX
"RTN","PSOCPF",257,0)
 . W !,$$WRAP(.LINE,.PFLG,80)
"RTN","PSOCPF",258,0)
 . F I=0:0 Q:'PFLG  W !,?22,$$WRAP(.LINE,.PFLG,58)
"RTN","PSOCPF",259,0)
 ;
"RTN","PSOCPF",260,0)
 K DIR
"RTN","PSOCPF",261,0)
 D PAUSE^VALM1
"RTN","PSOCPF",262,0)
 Q
"RTN","PSOCPF",263,0)
 ;
"RTN","PSOCPF",264,0)
WRAP(STR,FLG,CL) ;
"RTN","PSOCPF",265,0)
 ; STR - STRING TO BE WRAPPED PASSED IN BY REFERENCE SO IT CONTAINS THE REMAING PORTION OF STRING
"RTN","PSOCPF",266,0)
 ; FLG - FLAG TO INDICATE WRAPPING NEEDS TO OCCUR
"RTN","PSOCPF",267,0)
 ; CL - COLUMN LENGTH
"RTN","PSOCPF",268,0)
 ;
"RTN","PSOCPF",269,0)
 ; NO WRAPPING REQUIRED
"RTN","PSOCPF",270,0)
 I $L(STR)'>CL S FLG=0 Q STR
"RTN","PSOCPF",271,0)
 S FLG=1
"RTN","PSOCPF",272,0)
 N A,B,C
"RTN","PSOCPF",273,0)
 ; POSITION AFTER COLUMN WIDTH BREAK IS A SPACE
"RTN","PSOCPF",274,0)
 I $E(STR,CL+1)=" " S B=$E(STR,1,CL),STR=$E(STR,CL+2,999) Q B
"RTN","PSOCPF",275,0)
 S A=$E(STR,1,CL)
"RTN","PSOCPF",276,0)
 ; NO SPACES WITHIN COLUMN WITH, JUST BREAK AT COLUMN WIDTH
"RTN","PSOCPF",277,0)
 I $L(A," ")=1 S STR=$E(STR,CL+1,999) Q A
"RTN","PSOCPF",278,0)
 ; BREAK ON LAST SEMICOLON PIECE WITHIN COLUMN WIDTH
"RTN","PSOCPF",279,0)
 S C=$L(A," ")
"RTN","PSOCPF",280,0)
 S B=$P(A," ",1,C-1)
"RTN","PSOCPF",281,0)
 S STR=$P(A," ",C)_$E(STR,CL+1,999)
"RTN","PSOCPF",282,0)
 Q B
"RTN","PSOCPF1")
0^3^B49346922^n/a
"RTN","PSOCPF1",1,0)
PSOCPF1 ;BIR/BAA - Pharmacy CO-PAY Application Utilities for IB ;02/06/92
"RTN","PSOCPF1",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**463**;DEC 1997;Build 36
"RTN","PSOCPF1",3,0)
 ;
"RTN","PSOCPF1",4,0)
SORT ; get the data
"RTN","PSOCPF1",5,0)
 K ^TMP($J,"PSOCPF"),^TMP($J,"PSOCPFX"),^TMP($J,"PSOCPFC"),^TMP($J,"PSOCPFE")
"RTN","PSOCPF1",6,0)
 ; compile data to display here
"RTN","PSOCPF1",7,0)
 N BDATE,EDATE,RXS,PAT,FILDT,END,RIEN,RSX,RFL,DFN,VADM,VAEL
"RTN","PSOCPF1",8,0)
 S BDATE=$P(FILTERS(0),U,1),EDATE=$P(FILTERS(0),U,2)
"RTN","PSOCPF1",9,0)
 S RXS=$P(FILTERS(0),U,3),PAT=$P(FILTERS(0),U,4)
"RTN","PSOCPF1",10,0)
 S FILDT=BDATE-.01,END=EDATE+.9
"RTN","PSOCPF1",11,0)
 F  S FILDT=$O(^PSRX("AD",FILDT)) Q:FILDT>END  Q:FILDT=""  D
"RTN","PSOCPF1",12,0)
 . S RIEN=0 F  S RIEN=$O(^PSRX("AD",FILDT,RIEN)) Q:RIEN=""  D
"RTN","PSOCPF1",13,0)
 .. I RXS,'$D(FILTERS(1,RIEN)) Q
"RTN","PSOCPF1",14,0)
 .. S RFL=$O(^PSRX("AD",FILDT,RIEN,""))
"RTN","PSOCPF1",15,0)
 .. I '$D(^PSRX(RIEN,0)) Q
"RTN","PSOCPF1",16,0)
 .. S DFN=$$GET1^DIQ(52,RIEN_",",2,"I") I DFN="" Q  I '$D(^DPT(DFN,0)) Q
"RTN","PSOCPF1",17,0)
 .. I PAT'=DFN Q
"RTN","PSOCPF1",18,0)
 .. D GETDATA(RIEN)
"RTN","PSOCPF1",19,0)
 Q
"RTN","PSOCPF1",20,0)
 ;
"RTN","PSOCPF1",21,0)
GETDATA(RIEN) ;SET UP DATA FOR LIST MANAGER
"RTN","PSOCPF1",22,0)
 N PTNM,PID,MED,RX,IBST1,SC,SCP,MTSD,MTS,RNB,MIEN,DEBTOR
"RTN","PSOCPF1",23,0)
 N DRG,CPY,BLNO,ARST,ARST1,ARTRN,X,MREC,IBN,IBND,PBIL
"RTN","PSOCPF1",24,0)
 N PRIEN,PIBN
"RTN","PSOCPF1",25,0)
 S RX=$$GET1^DIQ(52,RIEN_",",.01,"E")
"RTN","PSOCPF1",26,0)
 S DRG=$$GET1^DIQ(52,RIEN_",",6,"I"),MED=$$GET1^DIQ(52,RIEN_",",6,"O")
"RTN","PSOCPF1",27,0)
 I DRG="" Q
"RTN","PSOCPF1",28,0)
 D DEM^VADPT S PTNM=VADM(1),PID=$P(VADM(2),U,1),PID=$E(PTNM,1)_$E(PID,6,9)
"RTN","PSOCPF1",29,0)
 D ELIG^VADPT S SC=$P(VAEL(3),U,1),SCP=$P(VAEL(3),U,2),MTS=$P(VAEL(9),U,2)
"RTN","PSOCPF1",30,0)
 S MTSD=$$GET1^DIQ(2,DFN_",",999.2,"I")
"RTN","PSOCPF1",31,0)
 S X=$$RXST^IBARXEU(DFN,DT),CPY=$P(X,U,2)
"RTN","PSOCPF1",32,0)
 I RFL S IBN=$$GET1^DIQ(52.1,RFL_","_RIEN,9,"I")
"RTN","PSOCPF1",33,0)
 I 'RFL S IBN=$$GET1^DIQ(52,RIEN_",",106,"I")
"RTN","PSOCPF1",34,0)
 I IBN="" S (PBIL,BLNO,ARTRN,PRIEN,ARST1,ARST,DEBTOR)="" Q
"RTN","PSOCPF1",35,0)
 ;
"RTN","PSOCPF1",36,0)
 S (PBIL,ARST1,ARST,BLNO,ARTRN,PBIL,PRIEN,PIBN,DEBTOR)=""
"RTN","PSOCPF1",37,0)
 S BLNO=$$GET1^DIQ(350,IBN_",",.11,"I")
"RTN","PSOCPF1",38,0)
 S ARTRN=$$GET1^DIQ(350,IBN_",",.12,"I")
"RTN","PSOCPF1",39,0)
 I ARTRN="" S PIBN=$$GET1^DIQ(350,IBN_",",.09,"I")
"RTN","PSOCPF1",40,0)
 I PIBN'="",PIBN'=IBN D
"RTN","PSOCPF1",41,0)
 . S ARTRN=$$GET1^DIQ(350,PIBN_",",.12,"I")
"RTN","PSOCPF1",42,0)
 . S ARST=$$GET1^DIQ(350,PIBN_",",.05,"I"),ARST1=$$GET1^DIQ(350,PIBN_",",.05,"O")_" CHARGE"
"RTN","PSOCPF1",43,0)
 I ARTRN'="" S (PBIL,PRIEN)=$$GET1^DIQ(433,ARTRN_",",.03,"I")
"RTN","PSOCPF1",44,0)
 I PIBN'="",PIBN=IBN D
"RTN","PSOCPF1",45,0)
 . S ARST=$$GET1^DIQ(350,PIBN_",",.05,"I"),ARST1=$$GET1^DIQ(350,PIBN_",",.05,"O")
"RTN","PSOCPF1",46,0)
 I BLNO="",PBIL'="" S BLNO=$$GET1^DIQ(430,PBIL_",",.01),DEBTOR=$$GET1^DIQ(430,PBIL_",",9,"I")
"RTN","PSOCPF1",47,0)
 I PRIEN'="",PIBN="" S ARST1=$$GET1^DIQ(430,PRIEN_",",8,"O"),ARST=$$GET1^DIQ(430,PRIEN_",",8,"I"),DEBTOR=$$GET1^DIQ(430,PRIEN_",",9,"I")
"RTN","PSOCPF1",48,0)
 I ARST="" S ARST=$$GET1^DIQ(350.21,IBN_",",.01,"I"),ARST1=$$GET1^DIQ(350.21,IBN_",",.01,"O")
"RTN","PSOCPF1",49,0)
 S ^TMP($J,"PSOCPF",PTNM,RIEN,RFL)=PTNM_U_PID_U_MED_U_RIEN_U_RFL_U_ARTRN_U_RX_U_FILDT_U_BLNO_U_ARST1_U_SC_U_SCP_U_MTSD_U_MTS_U_DFN_U_PBIL_U_ARST_U_PRIEN_U_IBN_U_CPY_U_DEBTOR
"RTN","PSOCPF1",50,0)
 Q
"RTN","PSOCPF1",51,0)
 ;
"RTN","PSOCPF1",52,0)
CANCEL ; CANCEL COPAY STATUS
"RTN","PSOCPF1",53,0)
 ;
"RTN","PSOCPF1",54,0)
 D FULL^VALM1
"RTN","PSOCPF1",55,0)
 N I,J,IBXX,VALMY,ECNT,NAME,GOTPAT,RC,IBFR,IBTO
"RTN","PSOCPF1",56,0)
 S CNT=0
"RTN","PSOCPF1",57,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","PSOCPF1",58,0)
 I $D(VALMY),$D(^TMP($J,"PSOCPF")) D
"RTN","PSOCPF1",59,0)
 . S IBXX=0 F  S IBXX=$O(VALMY(IBXX)) Q:'IBXX  D
"RTN","PSOCPF1",60,0)
 .. S RC=$G(^TMP($J,"PSOCPFX",IBXX)),CNT=CNT+1
"RTN","PSOCPF1",61,0)
 .. S NAME=$P(RC,U,1),PSODA=$P(RC,U,4),MED=$P(RC,U,3),RX=$P(RC,U,8),RFL=$P(RC,U,7)
"RTN","PSOCPF1",62,0)
 .. I '$D(PSOPAR) D ^PSOLSET
"RTN","PSOCPF1",63,0)
 .. W !!,?17,"PATIENT: ",NAME
"RTN","PSOCPF1",64,0)
 .. W !,?17,"Medication: ",MED
"RTN","PSOCPF1",65,0)
 .. W !,?17,"RX: ",RX_"-"_RFL
"RTN","PSOCPF1",66,0)
 .. D ICN^PSODPT($P(^PSRX(PSODA,0),"^",2))
"RTN","PSOCPF1",67,0)
 .. S PSORXN=$P(^PSRX(PSODA,0),"^"),PREA="R"
"RTN","PSOCPF1",68,0)
 .. S PCOPAY=$G(^PSRX(PSODA,"IB"))
"RTN","PSOCPF1",69,0)
 .. D ASKCAN
"RTN","PSOCPF1",70,0)
 D BLD^PSOCPF
"RTN","PSOCPF1",71,0)
 S VALMBCK="R"
"RTN","PSOCPF1",72,0)
 Q
"RTN","PSOCPF1",73,0)
 ;
"RTN","PSOCPF1",74,0)
RESET ; RESET/CANCEL COPAY STATUS
"RTN","PSOCPF1",75,0)
 ;
"RTN","PSOCPF1",76,0)
 D FULL^VALM1
"RTN","PSOCPF1",77,0)
 N I,J,IBXX,VALMY,ECNT,NAME,GOTPAT,RC,IBFR,IBTO
"RTN","PSOCPF1",78,0)
 S CNT=0
"RTN","PSOCPF1",79,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","PSOCPF1",80,0)
 I $D(VALMY),$D(^TMP($J,"PSOCPF")) D
"RTN","PSOCPF1",81,0)
 . S IBXX=0 F  S IBXX=$O(VALMY(IBXX)) Q:'IBXX  D
"RTN","PSOCPF1",82,0)
 .. S RC=$G(^TMP($J,"PSOCPFX",IBXX)),CNT=CNT+1
"RTN","PSOCPF1",83,0)
 .. S NAME=$P(RC,U,1),PSODA=$P(RC,U,4),MED=$P(RC,U,3),RX=$P(RC,U,8),RFL=$P(RC,U,7)
"RTN","PSOCPF1",84,0)
 .. D STATUS(PSODA,RFL)
"RTN","PSOCPF1",85,0)
 D BLD^PSOCPF
"RTN","PSOCPF1",86,0)
 S VALMBCK="R"
"RTN","PSOCPF1",87,0)
 Q
"RTN","PSOCPF1",88,0)
 ;
"RTN","PSOCPF1",89,0)
STATUS(PSODA,RFL) ; PROCESS STATUS CHANGE
"RTN","PSOCPF1",90,0)
 N PSOIBQ,PREA,PSI,PSOCOMM,FLAG,PSOSUMM,PSONW,PSOINDPT,PSONEW,PSOOLD
"RTN","PSOCPF1",91,0)
 S PSOSUMM=""
"RTN","PSOCPF1",92,0)
 I '$D(PSOPAR) D ^PSOLSET
"RTN","PSOCPF1",93,0)
 W !!,?17,"PATIENT: ",NAME
"RTN","PSOCPF1",94,0)
 W !,?17,"Medication: ",MED
"RTN","PSOCPF1",95,0)
 W !,?17,"RX: ",RX_"-"_RFL
"RTN","PSOCPF1",96,0)
 ;
"RTN","PSOCPF1",97,0)
 D ICN^PSODPT($P(^PSRX(PSODA,0),"^",2))
"RTN","PSOCPF1",98,0)
 S PSORXN=$P(^PSRX(PSODA,0),"^"),PREA="R"
"RTN","PSOCPF1",99,0)
 S PCOPAY=$G(^PSRX(PSODA,"IB"))
"RTN","PSOCPF1",100,0)
 W !!,"Rx # ",PSORXN," is a ",$S(+PCOPAY:"Copay",1:"No Copay")," prescription"
"RTN","PSOCPF1",101,0)
 S PSOLFIL=$$LF^PSOPFSU1(PSODA) D PFSA^PSOPFSU1(PSODA,PSOLFIL,3)  ;PSOCPC def PSOPFSA=1 if OP SC/EI's change.
"RTN","PSOCPF1",102,0)
 D EXEMCHK^PSOCPC ; CHECK/CHANGE EXEMPTION FLAGS
"RTN","PSOCPF1",103,0)
 S PSOIBQ=$G(^PSRX(PSODA,"IBQ"))
"RTN","PSOCPF1",104,0)
 ;
"RTN","PSOCPF1",105,0)
 I '$G(^PSRX(PSODA,"IB")),PSOIBQ'["1" D  G ASKCAN
"RTN","PSOCPF1",106,0)
 . K DIR S DIR(0)="Y",DIR("B")="N",DIR("A")="Do you want to reset the status to COPAY" D ^DIR K DIR
"RTN","PSOCPF1",107,0)
 . I Y'=1 Q
"RTN","PSOCPF1",108,0)
 . S DIC="^IBE(350.3,",DIC("S")="I $P(^(0),U,3)'=2",DIC(0)="AEQMZ",DIC("A")="Select Reason for Reset : " D ^DIC K DIC I Y'<0 S PSORSN=+Y
"RTN","PSOCPF1",109,0)
 . S PREA="R",PSOOLD="No Copay",PSONW="Copay",PSOCOMM="" D ACTLOG^PSOCPA
"RTN","PSOCPF1",110,0)
 . S PSI=0,PSOCOMM="Copay status of this Rx has been reset to COPAY." D SETSUMM^PSOCPC
"RTN","PSOCPF1",111,0)
 . S $P(^PSRX(PSODA,"IB"),"^")=1 ;Reset flag to COPAY
"RTN","PSOCPF1",112,0)
 ;
"RTN","PSOCPF1",113,0)
 I $G(^PSRX(PSODA,"IB")) D  G ASKCAN
"RTN","PSOCPF1",114,0)
 . K DIR S DIR(0)="Y",DIR("B")="N",DIR("A")="Do you want to reset the status to NO COPAYMENT" D ^DIR K DIR
"RTN","PSOCPF1",115,0)
 . I Y'=1 Q
"RTN","PSOCPF1",116,0)
 . S DIC="^IBE(350.3,",DIC("S")="I $P(^(0),U,3)'=2",DIC(0)="AEQMZ",DIC("A")="Select Reason for Reset : " D ^DIC K DIC I Y'<0 S PSORSN=+Y
"RTN","PSOCPF1",117,0)
 . S PREA="R",PSOOLD="Copay",PSONW="No Copay",PSOCOMM="" D ACTLOG^PSOCPA
"RTN","PSOCPF1",118,0)
 . S PSI=0,PSOCOMM="Copay status of this Rx has been reset to NO COPAY." D SETSUMM^PSOCPC
"RTN","PSOCPF1",119,0)
 . S $P(^PSRX(PSODA,"IB"),"^")="" ;Reset flag to NO COPAY
"RTN","PSOCPF1",120,0)
ASKCAN D ASKCAN^PSOCPD
"RTN","PSOCPF1",121,0)
 I $$FLAG(.PSOSUMM) S ^TMP($J,"PSOCPFC",NAME,PSODA,RFL)="Cancelled"
"RTN","PSOCPF1",122,0)
 D PRTSUMM^PSOCPB
"RTN","PSOCPF1",123,0)
RESETE K PSODA,PSORXN,PSORSN,PSOREF,X,Y,PCOPAY,PREA,PSOCOMM,PSI
"RTN","PSOCPF1",124,0)
 ;
"RTN","PSOCPF1",125,0)
FLAG(PSOSUMM) ; CHECK FOR CANCELLED CHARGE
"RTN","PSOCPF1",126,0)
 N FLAG,CNT
"RTN","PSOCPF1",127,0)
 S (CNT,FLAG)=0
"RTN","PSOCPF1",128,0)
 F  S CNT=$O(PSOSUMM(CNT)) Q:CNT=""  I PSOSUMM(CNT)["copay charge cancelled" S FLAG=1 Q
"RTN","PSOCPF1",129,0)
 Q FLAG
"RTN","PSOCPF1",130,0)
 ;
"RTN","PSOCPF1",131,0)
EXPORT ; -- print excel spreadsheet.
"RTN","PSOCPF1",132,0)
 I '$D(^TMP($J,"PSOCPF")) D BLD^PSOCPF S VALMBCK="R" Q
"RTN","PSOCPF1",133,0)
 D CLEAR^VALM1,FULL^VALM1
"RTN","PSOCPF1",134,0)
 S LCNT=0
"RTN","PSOCPF1",135,0)
 D ^%ZISC
"RTN","PSOCPF1",136,0)
 D DEVICE("EF")
"RTN","PSOCPF1",137,0)
 ;
"RTN","PSOCPF1",138,0)
 D BLD^PSOCPF
"RTN","PSOCPF1",139,0)
 D PAUSE^VALM1
"RTN","PSOCPF1",140,0)
 S VALMBCK="R"
"RTN","PSOCPF1",141,0)
 Q
"RTN","PSOCPF1",142,0)
 ;
"RTN","PSOCPF1",143,0)
EXCEL(FILTERS) ; print the data in excel format
"RTN","PSOCPF1",144,0)
 ;NAME_U_PID_U_MED_U_RX_"-"_RFL_U_$$FMTE^XLFDT(FILDT,"2DZ")_U_BLN_U_ARST1_U_SCO_U_SCP_U_MTS_U_MTSD_U_CPY
"RTN","PSOCPF1",145,0)
 U IO
"RTN","PSOCPF1",146,0)
 N LCNT,PCE,REC,OUT,NAME,XX,BCNT,CNT,NXT,ZZ,ZZ1,ZZ2,OUT
"RTN","PSOCPF1",147,0)
 N BDATE,EDATE,RIEN,RFL
"RTN","PSOCPF1",148,0)
 S BDATE=$$FMTE^XLFDT($P(FILTERS,U,1),"2DZ")
"RTN","PSOCPF1",149,0)
 S EDATE=$$FMTE^XLFDT($P(FILTERS,U,2),"2DZ")
"RTN","PSOCPF1",150,0)
 D EXHDR
"RTN","PSOCPF1",151,0)
 S LCNT=0,NAME=""
"RTN","PSOCPF1",152,0)
 F  S NAME=$O(^TMP($J,"PSOCPFE",NAME)) Q:NAME=""  D
"RTN","PSOCPF1",153,0)
 . S RIEN=0
"RTN","PSOCPF1",154,0)
 . F  S RIEN=$O(^TMP($J,"PSOCPFE",NAME,RIEN)) Q:RIEN=""  D
"RTN","PSOCPF1",155,0)
 .. S RFL=""
"RTN","PSOCPF1",156,0)
 .. F  S RFL=$O(^TMP($J,"PSOCPFE",NAME,RIEN,RFL)) Q:RFL=""  D
"RTN","PSOCPF1",157,0)
 ... S REC=^TMP($J,"PSOCPFE",NAME,RIEN,RFL)
"RTN","PSOCPF1",158,0)
 ... W !,REC
"RTN","PSOCPF1",159,0)
 W !,"END OF REPORT"
"RTN","PSOCPF1",160,0)
 Q
"RTN","PSOCPF1",161,0)
 ;
"RTN","PSOCPF1",162,0)
DEVICE(TYPE) ; Ask user to select device
"RTN","PSOCPF1",163,0)
 ;
"RTN","PSOCPF1",164,0)
 D CLEAR^VALM1
"RTN","PSOCPF1",165,0)
 D FULL^VALM1
"RTN","PSOCPF1",166,0)
 N %ZIS,CRT,MAXCNT,POP,IOST,MAXCNT,IOSL,ZTREQ
"RTN","PSOCPF1",167,0)
 W !,"NO QUEUING ALLOWED FOR THIS REPORT"
"RTN","PSOCPF1",168,0)
 W !,"This report must have a line length of at least 256.",!
"RTN","PSOCPF1",169,0)
 S %ZIS="M" D ^%ZIS G:POP ENQ
"RTN","PSOCPF1",170,0)
 ; print report
"RTN","PSOCPF1",171,0)
 I IOST["C-" S MAXCNT=IOSL-3,CRT=1
"RTN","PSOCPF1",172,0)
 E  S MAXCNT=IOSL,CRT=0
"RTN","PSOCPF1",173,0)
 ;
"RTN","PSOCPF1",174,0)
 I TYPE="EF" U IO D EXCEL(FILTERS(0))
"RTN","PSOCPF1",175,0)
 ;
"RTN","PSOCPF1",176,0)
 D ^%ZISC
"RTN","PSOCPF1",177,0)
 ; 
"RTN","PSOCPF1",178,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","PSOCPF1",179,0)
 ;
"RTN","PSOCPF1",180,0)
ENQ Q
"RTN","PSOCPF1",181,0)
 ;
"RTN","PSOCPF1",182,0)
EXHDR ; -- excel header
"RTN","PSOCPF1",183,0)
 N HDR
"RTN","PSOCPF1",184,0)
 ;^TMP($J,"PSOCPF",PTNM,RIEN,RFL)=PTNM_U_PID_U_MED_U_RIEN_U_RFL_U_RX_U_FILDT_U_BLNO_U_IBST1_U_SC_U_SCP_U_MTSD_U_MTS_U_DFN_U_IBST
"RTN","PSOCPF1",185,0)
 W !,"Reset/Cancel Report"
"RTN","PSOCPF1",186,0)
 W !,"From ",BDATE," TO ",EDATE
"RTN","PSOCPF1",187,0)
 S HDR="Patient Name"_U_"ID"_U_"MEDICATION"_U_"RX"_U_"FILL DATE"_U_"BILL NO."_U_"STATUS"_U_"SC"_U_"PERCENT"_U_"MEANS TEST"_U_"MEANS DATE"_U_"RX STATUS"
"RTN","PSOCPF1",188,0)
 W !,HDR
"RTN","PSOCPF1",189,0)
 Q
"RTN","PSOCPF2")
0^4^B16086034^n/a
"RTN","PSOCPF2",1,0)
PSOCPF2 ;BIR/BAA - Pharmacy CO-PAY Application Utilities for IB ;02/06/92
"RTN","PSOCPF2",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**463**;DEC 1997;Build 36
"RTN","PSOCPF2",3,0)
 ;
"RTN","PSOCPF2",4,0)
 Q
"RTN","PSOCPF2",5,0)
 ;^TMP($J,"PSOCPFX",VCNT)=NAME_U_DFN_U_MED_U_RIEN_U_BLN_U_PRIEN_U_RFL_U_RX_U_DEBTOR
"RTN","PSOCPF2",6,0)
 ;
"RTN","PSOCPF2",7,0)
PATACP ; ACTION - Account Profile (AP)
"RTN","PSOCPF2",8,0)
 D FULL^VALM1
"RTN","PSOCPF2",9,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","PSOCPF2",10,0)
 D CLEAR^VALM1
"RTN","PSOCPF2",11,0)
 I $D(VALMY),$D(^TMP($J,"PSOCPF")) D
"RTN","PSOCPF2",12,0)
 . S IBXX=0 F  S IBXX=$O(VALMY(IBXX)) Q:'IBXX  D
"RTN","PSOCPF2",13,0)
 .. N RCDEBTDA
"RTN","PSOCPF2",14,0)
 .. S RC=$G(^TMP($J,"PSOCPFX",IBXX))
"RTN","PSOCPF2",15,0)
 .. S RCDEBTDA=$P(RC,U,9)  ;Need DEBTOR for AP
"RTN","PSOCPF2",16,0)
 .. I 'RCDEBTDA D  Q
"RTN","PSOCPF2",17,0)
 ... W !!,"There is no Bill associated with this entry."
"RTN","PSOCPF2",18,0)
 ... D PAUSE^VALM1
"RTN","PSOCPF2",19,0)
 .. D EN^VALM("RCDP ACCOUNT PROFILE")
"RTN","PSOCPF2",20,0)
 D BLD^PSOCPF
"RTN","PSOCPF2",21,0)
 S VALMBCK="R"
"RTN","PSOCPF2",22,0)
 Q
"RTN","PSOCPF2",23,0)
 ;
"RTN","PSOCPF2",24,0)
BILPRO ; view BILL PROFILE
"RTN","PSOCPF2",25,0)
 D FULL^VALM1
"RTN","PSOCPF2",26,0)
 N I,J,IBXX,VALMY,ECNT,REC,RCBILLDA
"RTN","PSOCPF2",27,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","PSOCPF2",28,0)
 I $D(VALMY),$D(^TMP($J,"PSOCPF")) D
"RTN","PSOCPF2",29,0)
 . S IBXX=0 F  S IBXX=$O(VALMY(IBXX)) Q:'IBXX  D
"RTN","PSOCPF2",30,0)
 .. S REC=$G(^TMP($J,"PSOCPFX",IBXX))
"RTN","PSOCPF2",31,0)
 .. S RCBILLDA=$P(REC,U,6)
"RTN","PSOCPF2",32,0)
 .. I RCBILLDA="" D  Q
"RTN","PSOCPF2",33,0)
 ... W !!,"There is no Bill associated with this entry."
"RTN","PSOCPF2",34,0)
 ... D PAUSE^VALM1
"RTN","PSOCPF2",35,0)
 .. D EN^VALM("RCDP BILL PROFILE")
"RTN","PSOCPF2",36,0)
 D BLD^PSOCPF
"RTN","PSOCPF2",37,0)
 S VALMBCK="R"
"RTN","PSOCPF2",38,0)
 Q
"RTN","PSOCPF2",39,0)
 ;
"RTN","PSOCPF2",40,0)
TPJI ; view THIRD PARTY JOIN INQUIRY
"RTN","PSOCPF2",41,0)
 D FULL^VALM1
"RTN","PSOCPF2",42,0)
 N I,J,IBXX,VALMY,ECNT,DFN,GOPAT,REC
"RTN","PSOCPF2",43,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","PSOCPF2",44,0)
 I $D(VALMY),$D(^TMP($J,"PSOCPF")) D
"RTN","PSOCPF2",45,0)
 . S IBXX=0 F  S IBXX=$O(VALMY(IBXX)) Q:'IBXX  D
"RTN","PSOCPF2",46,0)
 .. S REC=$G(^TMP($J,"PSOCPFX",IBXX))
"RTN","PSOCPF2",47,0)
 .. S DFN=$P(REC,U,2)
"RTN","PSOCPF2",48,0)
 .. D EN^VALM("IBJT ACTIVE LIST")
"RTN","PSOCPF2",49,0)
 D BLD^PSOCPF
"RTN","PSOCPF2",50,0)
 S VALMBCK="R"
"RTN","PSOCPF2",51,0)
 Q
"RTN","PSOCPF2",52,0)
 ;
"RTN","PSOCPF2",53,0)
BILINQ ; view PATIENT BILLING INQUIRY
"RTN","PSOCPF2",54,0)
 D FULL^VALM1
"RTN","PSOCPF2",55,0)
 N I,J,IBXX,VALMY,ECNT,DFN,GOPAT,IBIL,REC,IBFULL,IBIFN
"RTN","PSOCPF2",56,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","PSOCPF2",57,0)
 I $D(VALMY),$D(^TMP($J,"PSOCPF")) D
"RTN","PSOCPF2",58,0)
 . S IBXX=0 F  S IBXX=$O(VALMY(IBXX)) Q:'IBXX  D
"RTN","PSOCPF2",59,0)
 .. S REC=$G(^TMP($J,"PSOCPFX",IBXX))
"RTN","PSOCPF2",60,0)
 .. S IBIL=$P(REC,U,5),IBFULL=1,IBIFN=""
"RTN","PSOCPF2",61,0)
 .. I IBIL="" D  Q
"RTN","PSOCPF2",62,0)
 ... W !!,"There is no Bill associated with this entry."
"RTN","PSOCPF2",63,0)
 ... D PAUSE^VALM1
"RTN","PSOCPF2",64,0)
 .. D EN^IBOLK
"RTN","PSOCPF2",65,0)
 D BLD^PSOCPF
"RTN","PSOCPF2",66,0)
 S VALMBCK="R"
"RTN","PSOCPF2",67,0)
 Q
"RTN","PSOCPF2",68,0)
 ;
"RTN","PSOCPF2",69,0)
PATINQ ; view PATIENT INQUIRY
"RTN","PSOCPF2",70,0)
 D FULL^VALM1
"RTN","PSOCPF2",71,0)
 N I,J,IBXX,VALMY,ECNT,DFN,GOPAT,REC
"RTN","PSOCPF2",72,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","PSOCPF2",73,0)
 I $D(VALMY),$D(^TMP($J,"PSOCPF")) D
"RTN","PSOCPF2",74,0)
 . S IBXX=0 F  S IBXX=$O(VALMY(IBXX)) Q:'IBXX  D
"RTN","PSOCPF2",75,0)
 .. S REC=$G(^TMP($J,"PSOCPFX",IBXX))
"RTN","PSOCPF2",76,0)
 .. S DFN=$P(REC,U,2)
"RTN","PSOCPF2",77,0)
 .. D EN^DGRPD
"RTN","PSOCPF2",78,0)
 D BLD^PSOCPF
"RTN","PSOCPF2",79,0)
 S VALMBCK="R"
"RTN","PSOCPF2",80,0)
 Q
"RTN","PSOCPF2",81,0)
 ;
"RTN","PSOCPF2",82,0)
NP ; -- change patient,date and prescriptions.
"RTN","PSOCPF2",83,0)
 N VALMQUIT,IBDFN,PAT,DFN,SDATE,TDATE,IBDATES,SAVFIL
"RTN","PSOCPF2",84,0)
 D FULL^VALM1
"RTN","PSOCPF2",85,0)
 I $D(^TMP($J,"PSOCPFF",0)) S FILTERS(0)=^TMP($J,"PSOCPFF",0),SAVFIL(0)=FILTERS(0)
"RTN","PSOCPF2",86,0)
 S R=""
"RTN","PSOCPF2",87,0)
 F  S R=$O(^TMP($J,"PSOCPFF",1,R)) Q:R=""  S SAVFIL(1,R)=^TMP($J,"PSOCPFF",1,R)
"RTN","PSOCPF2",88,0)
 ;
"RTN","PSOCPF2",89,0)
 K ^TMP($J,"PSOCPFF")
"RTN","PSOCPF2",90,0)
 S IBDFN=$P(FILTERS(0),U,4)
"RTN","PSOCPF2",91,0)
 S PAT=$$ONEPAT^PSOCPF()
"RTN","PSOCPF2",92,0)
 I PAT=-1 D RESET S VALMBCK="R" G NPQ
"RTN","PSOCPF2",93,0)
 S (DFN,$P(FILTERS(0),U,4))=+PAT
"RTN","PSOCPF2",94,0)
 S SDATE=$P(FILTERS(0),U,1)
"RTN","PSOCPF2",95,0)
 S TDATE=$P(FILTERS(0),U,2)
"RTN","PSOCPF2",96,0)
 S IBDATES="Fill Dates",IBDATES=$$FMDATES^PSOCPF(IBDATES,SDATE,TDATE)
"RTN","PSOCPF2",97,0)
 I $D(VALMQUIT) D RESET S VALMBCK="R" G NPQ
"RTN","PSOCPF2",98,0)
 D ADDRX^PSOCPF
"RTN","PSOCPF2",99,0)
 S $P(FILTERS(0),U,1)=$P(IBDATES,U,1),$P(FILTERS(0),U,2)=$P(IBDATES,U,2)
"RTN","PSOCPF2",100,0)
 S ^TMP($J,"PSOCPF")=FILTERS(0)
"RTN","PSOCPF2",101,0)
 S R=""
"RTN","PSOCPF2",102,0)
 F  S R=$O(FILTERS(1,R)) Q:R=""  S ^TMP($J,"PSOCPFF",1,R)=FILTERS(1,R)
"RTN","PSOCPF2",103,0)
 W !,"Please be patient while I gather the requested data.",!
"RTN","PSOCPF2",104,0)
 S VALMBG=1 D SORT^PSOCPF1,HDR^PSOCPF,BLD^PSOCPF
"RTN","PSOCPF2",105,0)
 S VALMBCK="R"
"RTN","PSOCPF2",106,0)
NPQ Q
"RTN","PSOCPF2",107,0)
 ;
"RTN","PSOCPF2",108,0)
 ;
"RTN","PSOCPF2",109,0)
RESET ; Reset filters to current patient
"RTN","PSOCPF2",110,0)
 S (DFN,$P(FILTERS(0),U,4))=IBDFN
"RTN","PSOCPF2",111,0)
 S FILTERS(0)=SAVFIL(0)
"RTN","PSOCPF2",112,0)
 S BDATE=$P(FILTERS(0),U,1),EDATE=$P(FILTERS(0),U,2)
"RTN","PSOCPF2",113,0)
 S RXS=$P(FILTERS(0),U,3),PAT=$P(FILTERS(0),U,4)
"RTN","PSOCPF2",114,0)
 S ^TMP($J,"PSOCPFF",0)=FILTERS(0)
"RTN","PSOCPF2",115,0)
 S R=""
"RTN","PSOCPF2",116,0)
 F  S R=$O(SAVFIL(1,R)) Q:R=""  S (FILTERS(1,R),^TMP($J,"PSOCPFF",1,R))=SAVFIL(1,R)
"RTN","PSOCPF2",117,0)
 Q
"VER")
8.0^22.2
"BLD",10189,6)
^431
**END**
**END**

